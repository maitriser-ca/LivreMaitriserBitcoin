<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Opérations</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-3">
<h2 id="transactions">Opérations</h2>
<div class="sectionbody">
<div class="sect2 data-line-6">
<h3 id="ch06_intro">Présentation</h3>
<div class="paragraph data-line-8">
<p>Les transactions sont la partie la plus importante du système Bitcoin. Tout le reste dans le bitcoin est conçu pour garantir que les transactions peuvent être créées, propagées sur le réseau, validées et finalement ajoutées au grand livre mondial des transactions (la chaîne de blocs). Les transactions sont des structures de données qui encodent le transfert de valeur entre les participants au système Bitcoin. Chaque transaction est une entrée publique dans la chaîne de blocs de bitcoin, le grand livre comptable mondial en partie double.</p>
</div>
<div class="paragraph data-line-10">
<p>Dans ce chapitre, nous examinerons toutes les différentes formes de transactions, ce qu&#8217;elles contiennent, comment les créer, comment elles sont vérifiées et comment elles deviennent partie intégrante de l&#8217;enregistrement permanent de toutes les transactions. Lorsque nous utilisons le terme &quot;portefeuille&quot; dans ce chapitre, nous faisons référence au logiciel qui construit les transactions, et pas seulement à la base de données des clés.</p>
</div>
</div>
<div class="sect2 data-line-13">
<h3 id="tx_structure">Transactions en détail</h3>
<div class="paragraph data-line-15">
<p>Dans <a href="#ch02_bitcoin_overview">[ch02_bitcoin_overview]</a>, nous avons examiné la transaction utilisée par Alice pour payer un café au comptoir à café de Bob à l&#8217;aide d&#8217;un explorateur de blocs (<a href="#alices_transactions_to_bobs_cafe">Transaction d&#8217;Alice au Bob&#8217;s Café</a>).</p>
</div>
<div class="paragraph data-line-17">
<p>L&#8217;application de l&#8217;explorateur de blocs montre une transaction de &quot;l&#8217;adresse&quot; d&#8217;Alice à &quot;l&#8217;adresse&quot; de Bob. Il s&#8217;agit d&#8217;une vue très simplifiée de ce qui est contenu dans une transaction. En fait, comme nous le verrons dans ce chapitre, une grande partie des informations affichées sont construites par l&#8217;explorateur de blocs et ne se trouvent pas réellement dans la transaction.</p>
</div>
<div id="alices_transactions_to_bobs_cafe" class="imageblock data-line-21">
<div class="content">
<img src="images/mbc2_0208.png" alt="Alice Coffee Transaction">
</div>
<div class="title">Figure 1. Transaction d&#8217;Alice au Bob&#8217;s Café</div>
</div>
<div class="sect3 data-line-24">
<h4 id="transactions_behind_the_scenes">Transactions: Dans les coulisses</h4>
<div class="paragraph data-line-26">
<p> Dans les coulisses, une transaction réelle est très différente d&#8217;une transaction fournie par un explorateur de blocs typique. En fait, la plupart des constructions de haut niveau que nous voyons dans les différentes interfaces utilisateur des applications bitcoin <em>n&#8217;existent pas réellement</em> dans le système Bitcoin.</p>
</div>
<div class="paragraph data-line-28">
<p>Nous pouvons utiliser l&#8217;interface de ligne de commande de Bitcoin Core (getrawtransaction et decoderawtransaction) pour récupérer la transaction &quot;brute&quot; d&#8217;Alice, la décoder et voir ce qu&#8217;elle contient. Le résultat ressemble à ceci :</p>
</div>
<div id="alice_tx" class="listingblock data-line-33">
<div class="title">La transaction d&#8217;Alice décodée</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "version": 1,
  "locktime": 0,
  "vin": [
    {
      "txid": "7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18",
      "vout": 0,
      "scriptSig" : "3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf",
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 0.01500000,
      "scriptPubKey": "OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY OP_CHECKSIG"
    },
    {
      "value": 0.08450000,
      "scriptPubKey": "OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG",
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph data-line-58">
<p>Vous remarquerez peut-être certaines choses à propos de cette transaction, principalement les choses qui manquent ! Où est l&#8217;adresse d&#8217;Alice ? Où est l&#8217;adresse de Bob ? Où est l&#8217;entrée 0.1 &quot;envoyée&quot; par Alice ? En bitcoin, il n&#8217;y a pas de pièces, pas d&#8217;expéditeurs, pas de destinataires, pas de soldes, pas de comptes et pas d&#8217;adresses. Toutes ces choses sont construites à un niveau supérieur pour le bénéfice de l&#8217;utilisateur, pour rendre les choses plus faciles à comprendre.</p>
</div>
<div class="paragraph data-line-60">
<p>Vous pouvez également remarquer de nombreux champs étranges et indéchiffrables et des chaînes hexadécimales. Ne vous inquiétez pas, nous expliquerons en détail chaque champ affiché ici dans ce chapitre.</p>
</div>
</div>
</div>
<div class="sect2 data-line-63">
<h3 id="tx_inputs_outputs">Sorties et entrées de transaction</h3>
<div class="paragraph data-line-65">
<p>La base fondamentale d&#8217;une transaction bitcoin est une <em>sortie de transaction</em>. Les sorties de transaction sont des morceaux indivisibles de monnaie bitcoin, enregistrés sur la chaîne de blocs et reconnus comme valides par l&#8217;ensemble du réseau. Les nœuds complets Bitcoin suivent toutes les sorties disponibles et utilisables, appelées <em>sorties de transaction non dépensées</em>, ou <em>UTXO</em>. La collection de tous les UTXO est connue sous le nom d'<em>ensemble UTXO</em> et compte actuellement des millions d&#8217;UTXO. L&#8217;ensemble UTXO augmente à mesure que de nouveaux UTXO sont créés et diminue lorsque UTXO est consommé. Chaque transaction représente un changement (transition d&#8217;état) dans l&#8217;ensemble UTXO.</p>
</div>
<div class="paragraph data-line-67">
<p>Lorsque nous disons que le portefeuille d&#8217;un utilisateur a &quot;reçu&quot; du bitcoin, nous voulons dire que le portefeuille a détecté sur la chaîne de blocs un UTXO pouvant être dépensé avec l&#8217;une des clés contrôlées par ce portefeuille. Ainsi, le &quot;solde&quot; de bitcoins d&#8217;un utilisateur est la somme de tous les UTXO que le portefeuille de l&#8217;utilisateur peut dépenser et qui peuvent être dispersés parmi des centaines de transactions et des centaines de blocs. Le concept de solde est créé par l&#8217;application de portefeuille. Le portefeuille calcule le solde de l&#8217;utilisateur en scannant la chaîne de blocs et en agrégeant la valeur de tout UTXO que le portefeuille peut dépenser avec les clés qu&#8217;il contrôle. La plupart des portefeuilles maintiennent une base de données ou utilisent un service de base de données pour stocker un ensemble de référence rapide de tous les UTXO qu&#8217;ils peuvent dépenser avec les clés qu&#8217;ils contrôlent.</p>
</div>
<div class="paragraph data-line-69">
<p><a href="#utxo-stxo">Chaîne de transaction de Joe à Gopesh en cours de construction sur la chaîne de blocs</a> affiche la chaîne de blocs à trois moments différents, alors que la chaîne de transaction de Joe à Gopesh est en cours de construction. Remarquez comment chaque transaction dépense un UTXO qui a été créé dans une transaction précédente, le transformant en une <em>sortie de transaction dépensée</em>, ou <em>STXO</em>. Puisque la transaction #1 (de Joe à Alice) dépense un seul UTXO (de Joe) et crée un seul UTXO (à Alice), elle ne modifie pas la taille de l&#8217;ensemble UTXO. D&#8217;autre part, les transactions #2 et #3 créent toutes deux des sorties de change à l&#8217;expéditeur, dépensant un seul UTXO et créant deux UTXO (le paiement et la sortie de change). Par conséquent, chacun d&#8217;eux augmente la taille de l&#8217;ensemble UTXO de 1.</p>
</div>
<div id="utxo-stxo" class="imageblock data-line-73">
<div class="content">
<img src="images/mbc2_0609.png" alt="&quot;Chaîne de transaction de Joe à Gopesh en cours de construction sur la blockchain&quot;">
</div>
<div class="title">Figure 2. Chaîne de transaction de Joe à Gopesh en cours de construction sur la chaîne de blocs</div>
</div>
<div class="paragraph data-line-75">
<p>Une sortie de transaction peut avoir une valeur arbitraire (entière) libellée comme un multiple de satoshis. Tout comme les dollars peuvent être divisés jusqu&#8217;à deux décimales sous forme de cents, le bitcoin peut être divisé jusqu&#8217;à huit décimales sous forme de satoshis. Bien qu&#8217;une sortie puisse avoir n&#8217;importe quelle valeur arbitraire, une fois créée, elle est indivisible. Il s&#8217;agit d&#8217;une caractéristique importante des sorties qui doit être soulignée : les sorties sont des unités de valeur <em>discrètes</em> et <em>indivisibles</em>, libellées en satoshis entiers. Une production non dépensée ne peut être consommée dans son intégralité que par une transaction.</p>
</div>
<div class="paragraph data-line-77">
<p>Si un UTXO est supérieur à la valeur souhaitée d&#8217;une transaction, il doit toujours être consommé dans son intégralité et le changement doit être généré dans la transaction. En d&#8217;autres termes, si vous avez un UTXO d&#8217;une valeur de 20 bitcoins et que vous souhaitez payer seulement 1 bitcoin, votre transaction doit consommer l&#8217;intégralité de l&#8217;UTXO de 20 bitcoins et produire deux sorties : une payant 1 bitcoin au destinataire souhaité et une autre payant 19 bitcoin en échange. retour dans votre portefeuille. En raison de la nature indivisible des sorties de transaction, la plupart des transactions bitcoin devront générer du change.</p>
</div>
<div class="paragraph data-line-79">
<p>Imaginez une cliente qui achète une boisson à 1,50 $, puise dans son portefeuille et essaie de trouver une combinaison de pièces et de billets de banque pour couvrir le coût de 1,50 $. L&#8217;acheteur choisira la monnaie exacte si disponible, par exemple un billet d&#8217;un dollar et deux quarts (un quart vaut 0,25 $), ou une combinaison de coupures plus petites (six quarts), ou si nécessaire, une unité plus grande comme un billet de 5 $. Si elle remet trop d&#8217;argent, disons 5 $, au propriétaire du magasin, elle s&#8217;attendra à 3,50 $ de monnaie, qu&#8217;elle remettra dans son portefeuille et qu&#8217;elle disposera pour de futures transactions.</p>
</div>
<div class="paragraph data-line-81">
<p>De même, une transaction bitcoin doit être créée à partir de l&#8217;UTXO d&#8217;un utilisateur dans toutes les dénominations disponibles pour cet utilisateur. Les utilisateurs ne peuvent pas couper un UTXO en deux, pas plus qu&#8217;ils ne peuvent couper un billet d&#8217;un dollar en deux et l&#8217;utiliser comme monnaie. L&#8217;application de portefeuille de l&#8217;utilisateur sélectionne généralement à partir de l&#8217;UTXO disponible de l&#8217;utilisateur pour composer un montant supérieur ou égal au montant de transaction souhaité.</p>
</div>
<div class="paragraph data-line-83">
<p>Comme dans la vraie vie, l&#8217;application bitcoin peut utiliser plusieurs stratégies pour satisfaire le montant de l&#8217;achat : combiner plusieurs unités plus petites, trouver la monnaie exacte ou utiliser une seule unité supérieure à la valeur de la transaction et rendre la monnaie. Tout cet assemblage complexe d&#8217;UTXO dépensables est effectué automatiquement par le portefeuille de l&#8217;utilisateur et est invisible pour les utilisateurs. Cela n&#8217;est pertinent que si vous construisez par programme des transactions brutes à partir d&#8217;UTXO.</p>
</div>
<div class="paragraph data-line-85">
<p>Une transaction consomme des sorties de transaction non dépensées précédemment enregistrées et crée de nouvelles sorties de transaction qui peuvent être consommées par une transaction future. De cette façon, des morceaux de valeur bitcoin passent d&#8217;un propriétaire à l&#8217;autre dans une chaîne de transactions consommant et créant des UTXO.</p>
</div>
<div class="paragraph data-line-87">
<p>L&#8217;exception à la chaîne de sortie et d&#8217;entrée est une type spécial de transaction appelé transaction <em>coinbase</em>, qui est la première transaction de chaque bloc. Cette transaction y est placée par le mineur &quot;gagnant&quot; et crée un tout nouveau bitcoin payable à ce mineur en récompense de l&#8217;exploitation minière. Cette transaction coinbase spéciale ne consomme pas d&#8217;UTXO ; à la place, il a un type spécial d&#8217;entrée appelé &quot;coinbase&quot;. C&#8217;est ainsi que la masse monétaire du bitcoin est créée pendant le processus de minage, comme nous le verrons dans <a href="#mining">[mining]</a>.</p>
</div>
<div class="admonitionblock tip data-line-90">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-91">
<p>Qu&#8217;est-ce qui vient en premier ? Entrées ou sorties, la poule ou l&#8217;œuf ? Strictement parlant, les sorties viennent en premier parce que les transactions coinbase, qui génèrent de nouveaux bitcoins, n&#8217;ont pas d&#8217;entrées et créent des sorties à partir de rien.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 data-line-95">
<h4 id="tx_outs">Sorties des transactions</h4>
<div class="paragraph data-line-97">
<p>Chaque transaction bitcoin crée des sorties, qui sont enregistrées sur le grand livre bitcoin. Presque toutes ces sorties, à une exception près (voir <a href="#op_return">[op_return]</a>) créent des morceaux de bitcoin utilisables appelés UTXO, qui sont ensuite reconnus par l&#8217;ensemble du réseau et disponibles pour que le propriétaire les dépense lors d&#8217;une future transaction.</p>
</div>
<div class="paragraph data-line-99">
<p>Les UTXO sont suivis par chaque client Bitcoin à nœud complet dans l&#8217;ensemble UTXO. Les nouvelles transactions consomment (dépensent) une ou plusieurs de ces sorties de l&#8217;ensemble UTXO.</p>
</div>
<div class="paragraph data-line-101">
<p>Les sorties de transaction se composent de deux parties :</p>
</div>
<div class="ulist data-line-103">
<ul>
<li class="data-line-103">
<p>Un montant de bitcoin, libellé en <em>satoshis</em>, la plus petite unité de bitcoin</p>
</li>
<li class="data-line-104">
<p>Un puzzle cryptographique qui détermine les conditions requises pour passer la sortie</p>
</li>
</ul>
</div>
<div class="paragraph data-line-106">
<p>Le puzzle cryptographique est également connu sous le nom de <em>script de verrouillage</em>, un <em>script de témoin</em> ou un scriptPubKey.</p>
</div>
<div class="paragraph data-line-108">
<p>Le langage de script de transaction, utilisé dans le script de verrouillage mentionné précédemment, est décrit en détail dans <a href="#tx_script">Scripts de transaction et langage de script</a>.</p>
</div>
<div class="paragraph data-line-110">
<p>Maintenant, regardons la transaction d&#8217;Alice (montrée précédemment dans <a href="#transactions_behind_the_scenes">Transactions: Dans les coulisses</a>) et voir si nous pouvons identifier les sorties. Dans l&#8217;encodage JSON, les sorties sont dans un tableau (liste) nommé vout :</p>
</div>
<div class="listingblock data-line-113">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vout": [
  {
    "value": 0.01500000,
    "scriptPubKey": "OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY
    OP_CHECKSIG"
  },
  {
    "value": 0.08450000,
    "scriptPubKey": "OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG",
  }
]</code></pre>
</div>
</div>
<div class="paragraph data-line-127">
<p>Comme vous pouvez le voir, la transaction contient deux sorties. Chaque sortie est définie par une valeur et un puzzle cryptographique. Dans l&#8217;encodage indiqué par Bitcoin Core, la valeur est indiquée en bitcoin, mais dans la transaction elle-même, elle est enregistrée sous la forme d&#8217;un entier libellé en satoshis. La deuxième partie de chaque sortie est le puzzle cryptographique qui fixe les conditions de dépenses. Bitcoin Core le montre comme scriptPubKey et nous montre une représentation lisible par l&#8217;homme du script.</p>
</div>
<div class="paragraph data-line-129">
<p>Le sujet du verrouillage et du déverrouillage de l&#8217;UTXO sera abordé plus tard, dans <a href="#tx_lock_unlock">Construction du script (Verrouiller + Déverrouiller)</a>. Le langage de script utilisé pour le script dans scriptPubKey est décrit dans <a href="#tx_script">Scripts de transaction et langage de script</a>. Mais avant d&#8217;approfondir ces sujets, nous devons comprendre la structure globale des entrées et sorties des transactions.</p>
</div>
<div class="sect4 data-line-131">
<h5 id="_sérialisation_des_transactions_sorties">Sérialisation des transactions: sorties</h5>
<div class="paragraph data-line-133">
<p>Lorsque les transactions sont transmises sur le réseau ou échangées entre applications, elles sont <em>sérialisées</em>. La sérialisation est le processus de conversion de la représentation interne d&#8217;une structure de données dans un format qui peut être transmis un octet à la fois, également appelé flux d&#8217;octets. La sérialisation est le plus souvent utilisée pour coder des structures de données à transmettre sur un réseau ou à stocker dans un fichier. Le format de sérialisation d&#8217;une sortie de transaction est affiché dans <a href="#tx_out_structure">Sérialisation des sorties de transaction</a>.</p>
</div>
<table id="tx_out_structure" class="tableblock frame-all grid-all stretch data-line-138">
<caption class="title">Table 1. Sérialisation des sorties de transaction</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 octets (petit-boutiste)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Montant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valeur du bitcoin en satoshis (10<sup>-8</sup> bitcoin)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1–9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille du script de verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur du script de verrouillage en octets, à suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script de verrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un script définissant les conditions nécessaires pour dépenser la sortie</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-145">
<p>La plupart des bibliothèques et frameworks bitcoin ne stockent pas les transactions en interne sous forme de flux d&#8217;octets, car cela nécessiterait une analyse complexe chaque fois que vous auriez besoin d&#8217;accéder à un seul champ. Pour plus de commodité et de lisibilité, les bibliothèques bitcoin stockent les transactions en interne dans des structures de données (généralement des structures orientées objet).</p>
</div>
<div class="paragraph data-line-147">
<p>Le processus de conversion de la représentation de flux d&#8217;octets d&#8217;une transaction en données de représentation interne d&#8217;une bibliothèque est appelée <em>désérialisation</em> ou <em>analyse des transactions</em>. Le processus de reconversion en un flux d&#8217;octets pour la transmission sur le réseau, pour le hachage ou pour le stockage sur disque est appelé <em>sérialisation</em>. La plupart des bibliothèques bitcoin ont des fonctions intégrées pour la sérialisation et la désérialisation des transactions.</p>
</div>
<div class="paragraph data-line-149">
<p>Voyez si vous pouvez décoder manuellement la transaction d&#8217;Alice à partir de la forme hexadécimale sérialisée, en trouvant certains des éléments que nous avons vus précédemment. La section contenant les deux sorties est mise en surbrillance dans <a href="#example_6_1">Transaction d&#8217;Alice, sérialisée et présentée en notation hexadécimale</a> pour vous aider :</p>
</div>
<div id="example_6_1" class="exampleblock data-line-153">
<div class="title">Example 1. Transaction d&#8217;Alice, sérialisée et présentée en notation hexadécimale</div>
<div class="content">
<div class="paragraph data-line-154">
<p>0100000001186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd73
4d2804fe65fa35779000000008b483045022100884d142d86652a3f47
ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039
ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813
01410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade84
16ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc1
7b4a10fa336a8d752adfffffffff02<strong>60e31600000000001976a914ab6</strong>
<strong>8025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef800000000000</strong>
<strong>1976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac</strong>
00000000</p>
</div>
</div>
</div>
<div class="paragraph data-line-166">
<p>Voici quelques conseils :</p>
</div>
<div class="ulist data-line-168">
<ul>
<li class="data-line-168">
<p>Il y a deux sorties dans la section en surbrillance, chacune sérialisée comme indiqué dans <a href="#tx_out_structure">Sérialisation des sorties de transaction</a>.</p>
</li>
<li class="data-line-169">
<p>La valeur de 0,015 bitcoin est de 1 500 000 satoshis. C&#8217;est 16 e3 60 en hexadécimal.</p>
</li>
<li class="data-line-170">
<p>Dans la transaction sérialisée, la valeur 16 e3 60 est encodée dans l&#8217;ordre d&#8217;octets petit-boutiste (octet le moins significatif en premier), elle ressemble donc à 60 e3 16.</p>
</li>
<li class="data-line-171">
<p>La longueur de scriptPubKey est de 25 octets, soit 19 en hexadécimal.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3 data-line-174">
<h4 id="tx_inputs">Entrées de transactions</h4>
<div class="paragraph data-line-176">
<p> Les entrées de transaction identifient (par référence) quel UTXO sera consommé et fournissent une preuve de propriété via un script de déverrouillage.</p>
</div>
<div class="paragraph data-line-178">
<p>Pour construire une transaction, un portefeuille sélectionne parmi l&#8217;UTXO qu&#8217;il contrôle, l&#8217;UTXO avec une valeur suffisante pour effectuer le paiement demandé. Parfois un UTXO suffit, d&#8217;autres fois plus d&#8217;un est nécessaire. Pour chaque UTXO qui sera consommé pour effectuer ce paiement, le portefeuille crée une entrée pointant vers l&#8217;UTXO et le déverrouille avec un script de déverrouillage.</p>
</div>
<div class="paragraph data-line-180">
<p>Examinons plus en détail les composants d&#8217;une entrée. La première partie d&#8217;une entrée est un pointeur vers un UTXO par référence au hachage de transaction et à un index de sortie, qui identifie l&#8217;UTXO spécifique dans cette transaction. La deuxième partie est un script de déverrouillage, que le portefeuille construit afin de satisfaire aux conditions de dépenses définies dans l&#8217;UTXO. Le plus souvent, le script de déverrouillage est une signature numérique et une clé publique prouvant la propriété du bitcoin. Cependant, ce ne sont pas tous les scripts de déverrouillage qui contiennent une signature. La troisième partie est un numéro de séquence, qui sera discuté plus tard.</p>
</div>
<div class="paragraph data-line-182">
<p>Considérez notre exemple dans <a href="#transactions_behind_the_scenes">Transactions: Dans les coulisses</a>. Les entrées de transaction sont un tableau (liste) appelé vin :</p>
</div>
<div id="vin" class="listingblock data-line-187">
<div class="title">Les entrées de transaction dans la transaction d&#8217;Alice</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vin": [
  {
    "txid": "7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18",
    "vout": 0,
    "scriptSig" : "3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf",
    "sequence": 4294967295
  }
]</code></pre>
</div>
</div>
<div class="paragraph data-line-198">
<p>Comme vous pouvez le voir, il n&#8217;y a qu&#8217;une seule entrée dans la liste (car un UTXO contenait une valeur suffisante pour effectuer ce paiement). L&#8217;entrée contient quatre éléments :</p>
</div>
<div class="ulist data-line-200">
<ul>
<li class="data-line-200">
<p>Un ID de transaction, faisant référence à la transaction qui contient l&#8217;UTXO dépensé</p>
</li>
<li class="data-line-201">
<p>Un index de sortie (vout), identifiant quel UTXO de cette transaction est référencé (le premier est zéro)</p>
</li>
<li class="data-line-202">
<p>Un scriptSig, qui satisfait aux conditions imposées à l&#8217;UTXO, le déverrouillant pour les dépenses</p>
</li>
<li class="data-line-203">
<p>Un numéro de séquence (à discuter plus tard)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-205">
<p>Dans la transaction d&#8217;Alice, l&#8217;entrée pointe vers l&#8217;ID de transaction :</p>
</div>
<div class="listingblock data-line-207">
<div class="content">
<pre>7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18</pre>
</div>
</div>
<div class="paragraph data-line-211">
<p>et l&#8217;indice de sortie 0 (c&#8217;est-à-dire le premier UTXO créé par cette transaction). Le script de déverrouillage est construit par le portefeuille d&#8217;Alice en récupérant d&#8217;abord l&#8217;UTXO référencé, en examinant son script de verrouillage, puis en l&#8217;utilisant pour créer le script de déverrouillage nécessaire pour le satisfaire.</p>
</div>
<div class="paragraph data-line-213">
<p>En regardant simplement l&#8217;entrée, vous avez peut-être remarqué que nous ne savons rien de cet UTXO, à part une référence à la transaction parent qui le contient. Nous ne connaissons pas sa valeur (montant en satoshi), et nous ne connaissons pas le script de verrouillage qui fixe les conditions pour le dépenser. Pour retrouver ces informations, il faut récupérer l&#8217;UTXO référencé en récupérant la transaction mère qui le contient. Notez que parce que la valeur de l&#8217;entrée n&#8217;est pas explicitement indiquée, nous devons également utiliser l&#8217;UTXO référencé afin de calculer les frais qui seront payés dans cette transaction (voir <a href="#tx_fees">Frais de transaction</a>).</p>
</div>
<div class="paragraph data-line-215">
<p>Ce n&#8217;est pas seulement le portefeuille d&#8217;Alice qui doit récupérer l&#8217;UTXO référencé dans les entrées. Une fois cette transaction diffusée sur le réseau, chaque nœud de validation devra également récupérer l&#8217;UTXO référencé dans les entrées de transaction afin de valider la transaction.</p>
</div>
<div class="paragraph data-line-217">
<p>Les transactions en elles-mêmes semblent incomplètes car elles manquent de contexte. Elles référencent l&#8217;UTXO dans leurs entrées mais sans récupérer cet UTXO on ne peut pas connaître la valeur des entrées ni leurs conditions de verrouillage. Lors de l&#8217;écriture d&#8217;un logiciel bitcoin, chaque fois que vous décodez une transaction dans le but de la valider ou de compter les frais ou de vérifier le script de déverrouillage, votre code devra d&#8217;abord récupérer l&#8217;UTXO référencé de la blockchain afin de construire le contexte implicite mais non présent dans les références UTXO des entrées. Par exemple, pour calculer le montant payé en frais, vous devez connaître la somme des valeurs des entrées et des sorties. Mais sans récupérer les UTXO référencés dans les entrées, vous ne connaissez pas leur valeur. Ainsi, une opération apparemment simple comme le comptage des frais dans une seule transaction implique en fait plusieurs étapes et des données provenant de plusieurs transactions.</p>
</div>
<div class="paragraph data-line-219">
<p>Nous pouvons utiliser la même séquence de commandes avec Bitcoin Core que celle que nous avons utilisée lors de la récupération de la transaction d&#8217;Alice (getrawtransaction et decoderawtransaction). Avec cela, nous pouvons obtenir l&#8217;UTXO référencé dans l&#8217;entrée de la transaction d&#8217;Alice et jeter un œil :</p>
</div>
<div id="alice_input_tx" class="listingblock data-line-224">
<div class="title">UTXO de la transaction précédente, référencé dans l&#8217;entrée de la transaction d&#8217;Alice</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vout": [
   {
     "value": 0.10000000,
     "scriptPubKey": "OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG"
   }
 ]</code></pre>
</div>
</div>
<div class="paragraph data-line-233">
<p>On voit que cet UTXO a une valeur de 0.1 BTC et qu&#8217;il a un script de verrouillage (scriptPubKey) qui contient &quot;OP_DUP OP_HASH160&#8230;&#8203;&quot;.</p>
</div>
<div class="admonitionblock tip data-line-236">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-237">
<p>Pour bien comprendre la transaction d&#8217;Alice, nous avons dû récupérer la transaction précédente référencée en entrée. Une fonction qui récupère les transactions précédentes et les sorties de transaction non dépensées est très courante et existe dans presque toutes les bibliothèques et API Bitcoin.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4 data-line-240">
<h5 id="_sérialisation_des_transactions_entrées">Sérialisation des transactions: entrées</h5>
<div class="paragraph data-line-242">
<p>Lorsque les transactions sont sérialisées pour être transmises sur le réseau, leurs entrées sont codées dans un flux d&#8217;octets comme indiqué dans <a href="#tx_in_structure">Sérialisation des entrées de transaction</a>.</p>
</div>
<table id="tx_in_structure" class="tableblock frame-all grid-all stretch data-line-247">
<caption class="title">Table 2. Sérialisation des entrées de transaction</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hachage de transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pointeur vers la transaction contenant l&#8217;UTXO à dépenser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indice de sortie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Le numéro d&#8217;index de l&#8217;UTXO à dépenser ; le premier est 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1–9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille du script de déverrouillage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur du script de déverrouillage en octets à suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Déverrouillage-Script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Un script remplissant les conditions du script de verrouillage UTXO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 octets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numéro de séquence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Utilisé pour le temps de verrouillage ou désactivé (0xFFFFFFFF)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-256">
<p>Comme pour les sorties, voyons si nous pouvons trouver les entrées de la transaction d&#8217;Alice au format sérialisé. Tout d&#8217;abord, les entrées décodées :</p>
</div>
<div class="listingblock data-line-259">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"vin": [
  {
    "txid": "7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18",
    "vout": 0,
    "scriptSig" : "3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf",
    "sequence": 4294967295
  }
],</code></pre>
</div>
</div>
<div class="paragraph data-line-270">
<p>Voyons maintenant si nous pouvons identifier ces champs dans le codage hexadécimal sérialisé dans <a href="#example_6_2">Transaction d&#8217;Alice, sérialisée et présentée en notation hexadécimale</a> :</p>
</div>
<div id="example_6_2" class="exampleblock data-line-274">
<div class="title">Example 2. Transaction d&#8217;Alice, sérialisée et présentée en notation hexadécimale</div>
<div class="content">
<div class="paragraph data-line-275">
<p>0100000001<strong>186f9f998a5aa6f048e51dd8419a14d8a0f1a8a2836dd73</strong>
<strong>4d2804fe65fa35779000000008b483045022100884d142d86652a3f47</strong>
<strong>ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039</strong>
<strong>ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</strong>
<strong>01410484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade84</strong>
<strong>16ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc1</strong>
<strong>7b4a10fa336a8d752adfffffffff</strong>0260e31600000000001976a914ab6
8025513c3dbd2f7b92a94e0581f5d50f654e788acd0ef800000000000
1976a9147f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a888ac00000
000</p>
</div>
</div>
</div>
<div class="paragraph data-line-287">
<p>Astuces:</p>
</div>
<div class="ulist data-line-289">
<ul>
<li class="data-line-289">
<p>L&#8217;ID de transaction est sérialisé dans l&#8217;ordre inverse des octets, il commence donc par (hex) 18 et se termine par 79</p>
</li>
<li class="data-line-290">
<p>L&#8217;index de sortie est un groupe de zéros de 4 octets, facile à identifier</p>
</li>
<li class="data-line-291">
<p>La longueur du scriptSig est de 139 octets, soit 8b en hexadécimal</p>
</li>
<li class="data-line-292">
<p>Le numéro de séquence est défini sur FFFFFFFF, encore une fois facile à identifier</p>
</li>
</ul>
</div>
<div class="paragraph data-line-294">
<p>ScriptSig est un type spécifique de script de déverrouillage qui, lorsqu&#8217;il est sérialisé pour être transmis sur le réseau, les entrées sont codées dans un flux d&#8217;octets, comme indiqué dans <a href="#scriptsig_in_structure">Sérialisation des entrées ScriptSig</a>. La sérialisation du champ signature est détaillée dans <a href="#seralization_of_signatures_der">Sérialisation des signatures (DER)</a>. Le champ de signature comprend également un type de hachage de signature (SIGHASH), qui est détaillé dans <a href="#sighash_types">Types de hachage de signature (SIGHASH)</a>.</p>
</div>
<table id="scriptsig_in_structure" class="tableblock frame-all grid-all stretch data-line-299">
<caption class="title">Table 3. Sérialisation des entrées ScriptSig</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Taille</th>
<th class="tableblock halign-left valign-top">Champ</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1–9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille signature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur de la signature en octets à suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Une signature produite par le portefeuille de l&#8217;utilisateur à partir de sa clé privée, qui comprend un SIGHASH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1–9 octets (VarInt)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taille de la clé publique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longueur de la clé publique en octets à suivre</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clé publique</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La clé publique, non hachée</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3 data-line-308">
<h4 id="tx_fees">Frais de transaction</h4>
<div class="paragraph data-line-310">
<p>La plupart des transactions incluent des frais de transaction, qui rémunèrent les mineurs de bitcoins pour la sécurisation du réseau. Les frais servent également de mécanisme de sécurité eux-mêmes, en rendant économiquement impossible pour les attaquants d&#8217;inonder le réseau de transactions. L&#8217;exploitation minière et les frais et récompenses perçus par les mineurs sont discutés plus en détail dans <a href="#mining">[mining]</a>.</p>
</div>
<div class="paragraph data-line-312">
<p>Cette section examine comment les frais de transaction sont inclus dans une transaction typique. La plupart des portefeuilles calculent et incluent automatiquement les frais de transaction. Toutefois, si vous créez des transactions par programmation ou à l&#8217;aide d&#8217;une interface de ligne de commande, vous devez comptabiliser et inclure manuellement ces frais.</p>
</div>
<div class="paragraph data-line-314">
<p>Les frais de transaction servent d&#8217;incitation à inclure (exploiter) une transaction dans le bloc suivant et également de dissuasion contre les abus du système en imposant un petit coût sur chaque transaction. Les frais de transaction sont perçus par le mineur qui exploite le bloc qui enregistre la transaction sur la chaîne de blocs.</p>
</div>
<div class="paragraph data-line-316">
<p>Les frais de transaction sont calculés en fonction de la taille de la transaction en kilo-octets, et non de la valeur de la transaction en bitcoin. Dans l&#8217;ensemble, les frais de transaction sont fixés en fonction des forces du marché au sein du réseau Bitcoin. Les mineurs hiérarchisent les transactions en fonction de nombreux critères différents, y compris les frais, et peuvent même traiter les transactions gratuitement dans certaines circonstances. Les frais de transaction affectent la priorité de traitement, ce qui signifie qu&#8217;une transaction avec des frais suffisants est susceptible d&#8217;être incluse dans le prochain bloc miné, alors qu&#8217;une transaction avec des frais insuffisants ou nuls peut être retardée, traitée au mieux après quelques blocs, ou pas traité du tout. Les frais de transaction ne sont pas obligatoires et les transactions sans frais peuvent éventuellement être traitées ; cependant, l&#8217;inclusion des frais de transaction encourage le traitement prioritaire.</p>
</div>
<div class="paragraph data-line-318">
<p>Au fil du temps, la façon dont les frais de transaction sont calculés et leur effet sur la hiérarchisation des transactions ont évolué. Au départ, les frais de transaction étaient fixes et constants sur l&#8217;ensemble du réseau. Progressivement, la structure tarifaire s&#8217;est assouplie et peut être influencée par les forces du marché, en fonction de la capacité du réseau et du volume des transactions. Depuis au moins le début de 2016, les limites de capacité en bitcoin ont créé une concurrence entre les transactions, entraînant des frais plus élevés et faisant des transactions gratuites une chose du passé. Les transactions sans frais ou à très faibles frais sont rarement minées et parfois ne seront même pas propagées sur le réseau.</p>
</div>
<div class="paragraph data-line-320">
<p>Dans Bitcoin Core, les politiques de relais des frais sont définies par l&#8217;option minrelaytxfee. Le minrelaytxfee par défaut actuel est de 0,00001 bitcoin ou un centième de millibitcoin par kilooctet. Par conséquent, par défaut, les transactions dont les frais sont inférieurs à 0,00001 bitcoin sont traitées comme gratuites et ne sont relayées que s&#8217;il y a de la place dans le mempool ; sinon, ils sont supprimés. Les nœuds Bitcoin peuvent remplacer la politique de relais de frais par défaut en ajustant la valeur de minrelaytxfee.</p>
</div>
<div class="paragraph data-line-322">
<p>Tout service bitcoin qui crée des transactions, y compris les portefeuilles, les échanges, les applications de vente au détail, etc., <em>doit</em> implémenter des frais dynamiques. Les frais dynamiques peuvent être mis en œuvre via un service tiers d&#8217;estimation des frais ou avec un algorithme d&#8217;estimation des frais intégré. Si vous n&#8217;êtes pas sûr, commencez par un service tiers et, à mesure que vous acquérez de l&#8217;expérience, concevez et implémentez votre propre algorithme si vous souhaitez supprimer la dépendance tierce.</p>
</div>
<div class="paragraph data-line-324">
<p>Les algorithmes d&#8217;estimation des frais calculent les frais appropriés, en fonction de la capacité et des frais offerts par les transactions « concurrentes ». Ces algorithmes vont du simple (frais moyens ou médians dans le dernier bloc) au sophistiqué (analyse statistique). Ils estiment les frais nécessaires (en satoshis par octet) qui donneront à une transaction une forte probabilité d&#8217;être sélectionnée et incluse dans un certain nombre de blocs. La plupart des services offrent aux utilisateurs la possibilité de choisir des frais de priorité élevés, moyens ou faibles. Une priorité élevée signifie que les utilisateurs paient des frais plus élevés, mais la transaction est susceptible d&#8217;être incluse dans le bloc suivant. Une priorité moyenne et faible signifie que les utilisateurs paient des frais de transaction moins élevés, mais que la confirmation des transactions peut prendre beaucoup plus de temps.</p>
</div>
<div class="paragraph data-line-326">
<p>De nombreuses applications de portefeuille utilisent des services tiers pour le calcul des frais. Un service populaire est <a href="https://bitcoinfees.earn.com/" data-href="https://bitcoinfees.earn.com/"><em>https://bitcoinfees.earn.com/</em></a>, qui fournit une API et un graphique visuel montrant les frais en satoshi/octet pour différentes priorités.</p>
</div>
<div class="admonitionblock tip data-line-329">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-330">
<p>Les frais statiques ne sont plus viables sur le réseau Bitcoin. Les portefeuilles qui fixent des frais statiques produiront une mauvaise expérience utilisateur car les transactions seront souvent &quot;bloquées&quot; et resteront non confirmées. Les utilisateurs qui ne comprennent pas les transactions et les frais en bitcoins sont consternés par les transactions &quot;bloquées&quot; car ils pensent avoir perdu leur argent.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-333">
<p>Le graphique en <a href="#bitcoinfeesearncom">Service d&#8217;estimation des frais bitcoinfees.earn.com</a> affiche l&#8217;estimation en temps réel des frais par incréments de 10 satoshi/octet et le temps de confirmation attendu (en minutes et en nombre de blocs) pour les transactions avec des frais dans chaque plage. Pour chaque fourchette de frais (par exemple, 61 à 70 satoshi/octet), deux barres horizontales indiquent le nombre de transactions non confirmées (1 405) et le nombre total de transactions au cours des dernières 24 heures (102 975), avec des frais compris dans cette fourchette. Sur la base du graphique, les frais de haute priorité recommandés à ce moment étaient de 80 satoshi/octet, des frais susceptibles d&#8217;entraîner l&#8217;inclusion de la transaction dans le bloc suivant (délai de bloc nul). Pour la perspective, la taille médiane des transactions est de 226 octets, donc les frais recommandés pour cette taille de transaction seraient de 18 080 satoshis (0,00018080 BTC).</p>
</div>
<div class="paragraph data-line-335">
<p>Les données d&#8217;estimation des frais peuvent être récupérées via une simple API HTTP REST, à l&#8217;adresse <a href="https://bitcoinfees.earn.com/api/v1/fees/recommended" data-href="https://bitcoinfees.earn.com/api/v1/fees/recommended">https://bitcoinfees.earn.com/api/v1/fees/recommended </a>. Par exemple, sur la ligne de commande en utilisant la commande curl :</p>
</div>
<div class="listingblock data-line-338">
<div class="title">Utilisation de l&#8217;API d&#8217;estimation des frais</div>
<div class="content">
<pre>$ curl https://bitcoinfees.earn.com/api/v1/fees/recommended

{"fastestFee":80,"halfHourFee":80,"hourFee":60}</pre>
</div>
</div>
<div class="paragraph data-line-344">
<p>L&#8217;API renvoie un objet JSON avec l&#8217;estimation actuelle des frais pour la confirmation la plus rapide (fastestFee), la confirmation dans les trois blocs (halfHourFee) et six blocs (hourFee), en satoshi par octet.</p>
</div>
<div id="bitcoinfeesearncom" class="imageblock data-line-348">
<div class="content">
<img src="images/mbc2_0602.png" alt="Service d&#8217;estimation des frais bitcoinfees.earn.com">
</div>
<div class="title">Figure 3. Service d&#8217;estimation des frais bitcoinfees.earn.com</div>
</div>
</div>
<div class="sect3 data-line-350">
<h4 id="_ajout_de_frais_aux_transactions">Ajout de frais aux transactions</h4>
<div class="paragraph data-line-352">
<p>La structure de données des transactions n&#8217;a pas de champ pour les frais. Au lieu de cela, les frais sont implicites comme la différence entre la somme des entrées et la somme des sorties. Tout montant excédentaire qui reste après que toutes les sorties ont été déduites de toutes les entrées est la redevance perçue par les mineurs :</p>
</div>
<div id="tx_fee_equation" class="listingblock data-line-356">
<div class="title">Les frais de transaction sont implicites, comme l&#8217;excédent des intrants moins les extrants :</div>
<div class="content">
<pre>Frais = Somme(intrants) - Somme(extrants)</pre>
</div>
</div>
<div class="paragraph data-line-360">
<p>Il s&#8217;agit d&#8217;un élément quelque peu déroutant des transactions et d&#8217;un point important à comprendre, car si vous construisez vos propres transactions, vous devez vous assurer de ne pas inclure par inadvertance des frais très importants en sous-dépensant les intrants. Cela signifie que vous devez comptabiliser toutes les entrées, si nécessaire en créant du change, ou vous finirez par donner un très gros pourboire aux mineurs !</p>
</div>
<div class="paragraph data-line-362">
<p>Par exemple, si vous consommez un UTXO de 20 bitcoins pour effectuer un paiement de 1 bitcoin, vous devez inclure une sortie de modification de 19 bitcoins dans votre portefeuille. Sinon, le &quot;reste&quot; de 19 bitcoins sera compté comme des frais de transaction et sera collecté par le mineur qui exploite votre transaction dans un bloc. Bien que vous receviez un traitement prioritaire et rendiez un mineur très heureux, ce n&#8217;est probablement pas ce que vous vouliez.</p>
</div>
<div class="admonitionblock warning data-line-365">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-366">
<p> Si vous oubliez d&#8217;ajouter une sortie de modification dans une transaction construite manuellement, vous paierez la modification en tant que frais de transaction. Dire &quot;Gardez la monnaie !&quot; au mineur n&#8217;est peut-être pas ce que vous vouliez vraiment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-369">
<p> Voyons comment cela fonctionne en pratique, en examinant à nouveau l&#8217;achat de café d&#8217;Alice. Alice veut dépenser 0,015 bitcoin pour payer son café. Pour s&#8217;assurer que cette transaction est traitée rapidement, elle voudra inclure des frais de transaction, disons 0,0005. Cela signifie que le coût total de la transaction sera de 0,0155. Son portefeuille doit donc se procurer un ensemble d&#8217;UTXO qui totalise 0,0155 bitcoin ou plus et, si nécessaire, créer de la monnaie. Disons que son portefeuille dispose d&#8217;un UTXO de 0,1 bitcoin. Elle devra donc consommer cet UTXO, créer une sortie pour le comptoir à café de Bob pour 0,015, et une seconde sortie avec 0,0845 bitcoin en retour vers son propre portefeuille, laissant 0,0005 bitcoin non alloué, comme frais implicites pour la transaction.</p>
</div>
<div class="paragraph data-line-371">
<p>Regardons maintenant un scénario différent. Eugenia, directrice de notre association caritative pour enfants aux Philippines, a organisé une collecte de fonds pour acheter des manuels scolaires pour les enfants. Elle a reçu plusieurs milliers de petits dons de personnes du monde entier, totalisant 50 bitcoins, donc son portefeuille est plein de très petits paiements (UTXO). Maintenant, elle veut acheter des centaines de manuels scolaires auprès d&#8217;un éditeur local, en payant en bitcoins.</p>
</div>
<div class="paragraph data-line-373">
<p>Alors que l&#8217;application de portefeuille d&#8217;Eugenia tente de construire une seule transaction de paiement plus importante, elle doit s&#8217;approvisionner à partir de l&#8217;ensemble UTXO disponible, qui est composé de nombreux montants plus petits. Cela signifie que la transaction résultante proviendra de plus d&#8217;une centaine d&#8217;UTXO de petite valeur en tant qu&#8217;entrées et d&#8217;une seule sortie, payant l&#8217;éditeur du livre. Une transaction avec autant d&#8217;entrées sera supérieure à un kilo-octet, peut-être plusieurs kilo-octets. En conséquence, cela nécessitera des frais beaucoup plus élevés que la transaction de taille médiane.</p>
</div>
<div class="paragraph data-line-375">
<p>L&#8217;application de portefeuille d&#8217;Eugenia calculera les frais appropriés en mesurant la taille de la transaction et en la multipliant par les frais par kilo-octet. De nombreux portefeuilles surpayeront les frais pour les transactions plus importantes afin de s&#8217;assurer que la transaction est traitée rapidement. Les frais plus élevés ne sont pas dus au fait qu&#8217;Eugenia dépense plus d&#8217;argent, mais au fait que sa transaction est plus complexe et plus volumineuse - les frais sont indépendants de la valeur en bitcoins de la transaction.</p>
</div>
</div>
</div>
<div class="sect2 pagebreak-before less_space_h1 data-line-379">
<h3 id="tx_script">Scripts de transaction et langage de script</h3>
<div class="paragraph data-line-381">
<p>Le langage de script de transaction bitcoin, appelé <em>Script</em> , est un langage d&#8217;exécution basé sur une pile de notation polonaise inversée (RPN) de type Forth. Si cela ressemble à du charabia, vous n&#8217;avez probablement pas étudié les langages de programmation des années 1960, mais ce n&#8217;est pas grave, nous vous expliquerons tout dans ce chapitre. Le script de verrouillage placé sur un UTXO et le script de déverrouillage sont écrits dans ce langage de script. Lorsqu&#8217;une transaction est validée, le script de déverrouillage de chaque entrée est exécuté parallèlement au script de verrouillage correspondant pour voir s&#8217;il satisfait à la condition de dépense.</p>
</div>
<div class="paragraph data-line-383">
<p>Script est un langage très simple qui a été conçu pour être limité dans sa portée et être exécutable sur une gamme de matériel et peut être aussi simple qu&#8217;un périphérique intégré. Il nécessite un traitement minimal et ne peut pas faire la plupart des choses fantaisistes que les langages de programmation modernes peuvent faire. Pour son utilisation dans la validation de monnaie programmable, il s&#8217;agit d&#8217;une fonction de sécurité délibérée.</p>
</div>
<div class="paragraph data-line-385">
<p>Aujourd&#8217;hui, la plupart des transactions traitées via le réseau Bitcoin ont la forme &quot;Paiement à l&#8217;adresse Bitcoin de Bob&quot; et sont basées sur un script appelé Pay-to-Script Public-Key-Hash. Cependant, les transactions bitcoin ne se limitent pas au script &quot;Paiement à l&#8217;adresse Bitcoin de Bob&quot;. En fait, les scripts de verrouillage peuvent être écrits pour exprimer une grande variété de conditions complexes. Afin de comprendre ces scripts plus complexes, nous devons d&#8217;abord comprendre les bases des scripts de transaction et du langage de script.</p>
</div>
<div class="paragraph data-line-387">
<p>Dans cette section, nous démontrerons les composants de base du langage de script de transaction bitcoin et montrerons comment il peut être utilisé pour exprimer des conditions simples de dépenses et comment ces conditions peuvent être satisfaites en déverrouillant des scripts.</p>
</div>
<div class="admonitionblock tip data-line-390">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-391">
<p>La validation des transactions Bitcoin n&#8217;est pas basée sur un modèle statique, mais est plutôt obtenue grâce à l&#8217;exécution d&#8217;un langage de script. Ce langage permet d&#8217;exprimer une variété presque infinie de conditions. C&#8217;est ainsi que le bitcoin obtient le pouvoir de &quot;l&#8217;argent programmable&quot;.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 data-line-395">
<h4 id="_incomplétude_de_turing">Incomplétude de Turing</h4>
<div class="paragraph data-line-397">
<p>Le langage de script de transaction bitcoin contient de nombreux opérateurs, mais est délibérément limité d&#8217;une manière importante : il n&#8217;y a pas de boucles ou de capacités de contrôle de flux complexes autres que le contrôle de flux conditionnel. Cela garantit que le langage n&#8217;est pas <em>Turing complet</em>, ce qui signifie que les scripts ont une complexité limitée et des temps d&#8217;exécution prévisibles. Le script n&#8217;est pas un langage universel. Ces limitations garantissent que le langage ne peut pas être utilisé pour créer une boucle infinie ou une autre forme de &quot;bombe logique&quot; qui pourrait être intégrée dans une transaction de manière à provoquer une attaque par déni de service contre le réseau Bitcoin. N&#8217;oubliez pas que chaque transaction est validée par chaque nœud complet du réseau Bitcoin. Un langage limité empêche le mécanisme de validation des transactions d&#8217;être utilisé comme une vulnérabilité.</p>
</div>
</div>
<div class="sect3 data-line-399">
<h4 id="_vérification_sans_état">Vérification sans état</h4>
<div class="paragraph data-line-401">
<p>Le langage de script de transaction bitcoin est sans état, en ce sens qu&#8217;il n&#8217;y a pas d&#8217;état avant l&#8217;exécution du script, ou d&#8217;état enregistré après l&#8217;exécution du script. Par conséquent, toutes les informations nécessaires à l&#8217;exécution d&#8217;un script sont contenues dans le script. Un script s&#8217;exécutera de manière prévisible de la même manière sur n&#8217;importe quel système. Si votre système vérifie un script, vous pouvez être sûr que tous les autres systèmes du réseau Bitcoin vérifieront également le script, ce qui signifie qu&#8217;une transaction valide est valide pour tout le monde et tout le monde le sait. Cette prévisibilité des résultats est un avantage essentiel du système Bitcoin.</p>
</div>
</div>
<div class="sect3 data-line-404">
<h4 id="tx_lock_unlock">Construction du script (Verrouiller + Déverrouiller)</h4>
<div class="paragraph data-line-406">
<p>Le moteur de validation des transactions de Bitcoin s&#8217;appuie sur deux types de scripts pour valider les transactions : un script de verrouillage et un script de déverrouillage.</p>
</div>
<div class="paragraph data-line-408">
<p>Un script de verrouillage est une condition de dépense placée sur une sortie : il spécifie les conditions qui doivent être remplies pour dépenser la production à l&#8217;avenir. Historiquement, le script de verrouillage était appelé <em>scriptPubKey</em>, car il contenait généralement une clé publique ou une adresse Bitcoin (hachage de clé publique). Dans ce livre, nous l&#8217;appelons un &quot;script de verrouillage&quot; pour reconnaître l&#8217;éventail de possibilités beaucoup plus large de cette technologie de script. Dans la plupart des applications bitcoin, ce que nous appelons un script de verrouillage apparaîtra dans le code source sous la forme scriptPubKey. Vous verrez également le script de verrouillage appelé <em>script de témoin</em> (voir <a href="#segwit">[segwit]</a>) ou plus généralement comme un <em>casse-tête cryptographique</em>. Ces termes signifient tous la même chose, à différents niveaux d&#8217;abstraction.</p>
</div>
<div class="paragraph data-line-410">
<p>Un script de déverrouillage est un script qui « résout », ou satisfait, les conditions placées sur une sortie par un script de verrouillage et permet à la sortie d&#8217;être dépensée. Les scripts de déverrouillage font partie de chaque entrée de transaction. Ils contiennent la plupart du temps une signature numérique produite par le portefeuille de l&#8217;utilisateur à partir de sa clé privée. Historiquement, le script de déverrouillage s&#8217;appelait <em>scriptSig</em>, car il contenait généralement une signature numérique. Dans la plupart des applications bitcoin, le code source fait référence au script de déverrouillage sous la forme scriptSig. Vous verrez également le script de déverrouillage appelé <em>témoin</em> (voir <a href="#segwit">[segwit]</a>). Dans ce livre, nous l&#8217;appelons un &quot;script de déverrouillage&quot; pour reconnaître la gamme beaucoup plus large d&#8217;exigences de script de verrouillage, car ce n&#8217;est pas tous les scripts de déverrouillage qui doivent contenir des signatures.</p>
</div>
<div class="paragraph data-line-412">
<p>Chaque nœud de validation Bitcoin validera les transactions en exécutant les scripts de verrouillage et de déverrouillage ensemble. Chaque entrée contient un script de déverrouillage et fait référence à un UTXO existant précédemment. Le logiciel de validation copiera le script de déverrouillage, récupérera l&#8217;UTXO référencé par l&#8217;entrée et copiera le script de verrouillage à partir de cet UTXO. Les scripts de déverrouillage et de verrouillage sont ensuite exécutés en séquence. L&#8217;entrée est valide si le script de déverrouillage satisfait les conditions du script de verrouillage (voir <a href="#script_exec">Exécution séparée des scripts de déverrouillage et de verrouillage</a>). Toutes les entrées sont validées indépendamment, dans le cadre de la validation globale de la transaction.</p>
</div>
<div class="paragraph data-line-414">
<p>Notez que l&#8217;UTXO est enregistré en permanence dans la blockchain, et est donc invariable et n&#8217;est pas affecté par les tentatives infructueuses de le dépenser par référence dans une nouvelle transaction. Seule une transaction valide qui satisfait correctement les conditions de la sortie entraîne que la sortie est considérée comme &quot;dépensée&quot; et retirée de l&#8217;ensemble des sorties de transaction non dépensées (ensemble UTXO).</p>
</div>
<div class="paragraph data-line-416">
<p><a href="#scriptSig_and_scriptPubKey">Combiner scriptSig et scriptPubKey pour évaluer un script de transaction</a> est un exemple des scripts de déverrouillage et de verrouillage pour le type de transaction bitcoin le plus courant (un paiement à un hachage de clé publique), montrant le script combiné résultant de la concaténation des scripts de déverrouillage et de verrouillage avant la validation du script.</p>
</div>
<div id="scriptSig_and_scriptPubKey" class="imageblock data-line-420">
<div class="content">
<img src="images/mbc2_0603.png" alt="&quot;scriptSig_and_scriptPubKey&quot;">
</div>
<div class="title">Figure 4. Combiner scriptSig et scriptPubKey pour évaluer un script de transaction</div>
</div>
<div class="sect4 data-line-422">
<h5 id="_la_pile_dexécution_de_script">La pile d&#8217;exécution de script</h5>
<div class="paragraph data-line-424">
<p>Le langage de script de Bitcoin est appelé un langage basé sur la pile car il utilise une structure de données appelée <em>pile</em>. Une pile est une structure de données très simple qui peut être visualisée comme une pile de cartes. Une pile permet deux opérations : push et pop. Push ajoute un élément au sommet de la pile. Pop supprime l&#8217;élément du haut de la pile. Les opérations sur une pile ne peuvent agir que sur l&#8217;élément le plus haut de la pile. Une structure de données de pile est également appelée file d&#8217;attente Last-In-First-Out (dernier entré, premier sorti), ou &quot;LIFO&quot;.</p>
</div>
<div class="paragraph data-line-426">
<p>Le langage de script exécute le script en traitant chaque élément de gauche à droite. Les nombres (constantes de données) sont poussés sur la pile. Les opérateurs poussent ou sortent un ou plusieurs paramètres de la pile, agissent sur eux et peuvent pousser un résultat sur la pile. Par exemple, OP_ADD fera sortir deux éléments de la pile, les ajoutera et poussera la somme résultante sur la pile.</p>
</div>
<div class="paragraph data-line-428">
<p>Les opérateurs conditionnels évaluent une condition, produisant un résultat booléen VRAI (TRUE) ou FAUX (FALSE). Par exemple, OP_EQUAL dépile deux éléments de la pile et pousse TRUE (TRUE est représenté par le nombre 1) s&#8217;ils sont égaux ou FALSE (représenté par zéro) s&#8217;ils ne sont pas égaux. Les scripts de transaction Bitcoin contiennent généralement un opérateur conditionnel, afin qu&#8217;ils puissent produire le résultat TRUE qui signifie une transaction valide.</p>
</div>
</div>
<div class="sect4 data-line-430">
<h5 id="_un_script_simple">Un script simple</h5>
<div class="paragraph data-line-432">
<p>Appliquons maintenant ce que nous avons appris sur les scripts et les piles à quelques exemples simples.</p>
</div>
<div class="paragraph data-line-434">
<p>Dans <a href="#simplemath_script">La validation du script Bitcoin en calculs simples</a>, le script 2 3 OP_ADD 5 OP_EQUAL démontre l&#8217;opérateur d&#8217;addition arithmétique OP_ADD, additionnant deux nombres et mettant le résultat sur la pile, suivi de l&#8217;opérateur conditionnel OP_EQUAL, qui vérifie que la somme résultante est égale à 5. Par souci de brièveté, le préfixe OP_ est omis dans l&#8217;exemple étape par étape. Pour plus de détails sur les opérateurs de script et les fonctions disponibles, voir <a href="#tx_script_ops">[tx_script_ops]</a>.</p>
</div>
<div class="paragraph data-line-436">
<p>Bien que la plupart des scripts de verrouillage se réfèrent à un hachage de clé publique (essentiellement, une adresse Bitcoin), nécessitant ainsi une preuve de propriété pour dépenser les fonds, le script n&#8217;a pas besoin d&#8217;être aussi complexe. Toute combinaison de scripts de verrouillage et de déverrouillage donnant une valeur TRUE est valide. L&#8217;arithmétique simple que nous avons utilisée comme exemple de langage de script est également un script de verrouillage valide qui peut être utilisé pour verrouiller une sortie de transaction.</p>
</div>
<div class="paragraph data-line-438">
<p>Utilisez une partie de l&#8217;exemple de script arithmétique comme script de verrouillage :</p>
</div>
<div class="listingblock data-line-440">
<div class="content">
<pre>3 OP_ADD 5 OP_EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-444">
<p>qui peut être satisfaite par une transaction contenant une entrée avec le script de déverrouillage :</p>
</div>
<div class="listingblock data-line-446">
<div class="content">
<pre>2</pre>
</div>
</div>
<div class="paragraph data-line-450">
<p>Le logiciel de validation combine les scripts de verrouillage et de déverrouillage et le script résultant est :</p>
</div>
<div class="listingblock data-line-452">
<div class="content">
<pre>2 3 OP_ADD 5 OP_EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-456">
<p>Comme nous l&#8217;avons vu dans l&#8217;exemple étape par étape dans <a href="#simplemath_script">La validation du script Bitcoin en calculs simples</a>, lorsque ce script est exécuté, le résultat est OP_TRUE, rendant la transaction valide. Non seulement il s&#8217;agit d&#8217;un script de verrouillage de sortie de transaction valide, mais l&#8217;UTXO résultant pourrait être dépensé par toute personne ayant les compétences en arithmétique pour savoir que le nombre 2 satisfait le script.</p>
</div>
<div class="admonitionblock tip data-line-459">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-460">
<p>Les transactions sont valides si le premier résultat de la pile est TRUE (noté {0x01}), toute autre valeur différente de zéro, autre que OP_0, ou si la pile est vide après l&#8217;exécution du script. Les transactions ne sont pas valides si la valeur supérieure de la pile est FALSE (une valeur vide de longueur nulle, notée {}) ou si l&#8217;exécution du script est arrêtée explicitement par un opérateur, tel que OP_VERIFY, OP_RETURN ou un terminateur conditionnel tel que OP_ENDIF. Voir <a href="#tx_script_ops">[tx_script_ops]</a> pour plus de détails.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="simplemath_script" class="imageblock data-line-465">
<div class="content">
<img src="images/mbc2_0604.png" alt="&quot;TxScriptSimpleMathExample&quot;">
</div>
<div class="title">Figure 5. La validation du script Bitcoin en calculs simples</div>
</div>
<div class="paragraph pagebreak-before data-line-468">
<p>Ce qui suit est un script légèrement plus complexe, qui calcule 2 + 7 - 3 + 1. Notez que lorsque le script contient plusieurs opérateurs à la suite, la pile permet aux résultats d&#8217;un opérateur d&#8217;être appliqués par l&#8217;opérateur suivant :</p>
</div>
<div class="listingblock data-line-470">
<div class="content">
<pre>2 7 OP_ADD 3 OP_SUB 1 OP_ADD 7 OP_EQUAL</pre>
</div>
</div>
<div class="paragraph data-line-474">
<p>Essayez de valider vous-même le script précédent à l&#8217;aide d&#8217;un crayon et de papier. Lorsque l&#8217;exécution du script se termine, vous devriez vous retrouver avec la valeur TRUE sur la pile.</p>
</div>
</div>
<div class="sect4 data-line-477">
<h5 id="script_exec">Exécution séparée des scripts de déverrouillage et de verrouillage</h5>
<div class="paragraph data-line-479">
<p>Dans le client Bitcoin d&#8217;origine, les scripts de déverrouillage et de verrouillage étaient concaténés et exécutés en séquence. Pour des raisons de sécurité, cela a été modifié en 2010, en raison d&#8217;une vulnérabilité qui permettait à un script de déverrouillage malformé de pousser des données sur la pile et de corrompre le script de verrouillage. Dans l&#8217;implémentation actuelle, les scripts sont exécutés séparément avec la pile transférée entre les deux exécutions, comme décrit ci-après.</p>
</div>
<div class="paragraph data-line-481">
<p>Tout d&#8217;abord, le script de déverrouillage est exécuté à l&#8217;aide du moteur d&#8217;exécution de la pile. Si le script de déverrouillage est exécuté sans erreur (par exemple, s&#8217;il ne reste plus de pointeurs &quot; pendants&quot;), la pile principale est copiée et le script de verrouillage est exécuté. Si le résultat de l&#8217;exécution du script de verrouillage avec les données de la pile copiées à partir du script de déverrouillage est &quot;TRUE&quot;, le script de déverrouillage a réussi à résoudre les conditions imposées par le script de verrouillage et, par conséquent, l&#8217;entrée est une autorisation valide de dépenser l&#8217;UTXO. S&#8217;il reste un résultat autre que &quot;TRUE&quot; après l&#8217;exécution du script combiné, l&#8217;entrée est invalide car elle n&#8217;a pas satisfait aux conditions de dépenses placées sur l&#8217;UTXO.</p>
</div>
</div>
</div>
<div class="sect3 data-line-485">
<h4 id="p2pkh">Pay-to-Public-Key-Hash (P2PKH)</h4>
<div class="paragraph data-line-487">
<p>La grande majorité des transactions traitées sur le réseau Bitcoin dépensent des sorties verrouillées avec un script Pay-to-Public-Key-Hash ou &quot;P2PKH&quot;. Ces sorties contiennent un script de verrouillage qui verrouille la sortie sur un hachage de clé publique, plus communément appelé adresse Bitcoin. Une sortie verrouillée par un script P2PKH peut être déverrouillée (passée) en présentant une clé publique et une signature numérique créée par la clé privée correspondante (voir <a href="#digital_sigs">Signatures numériques (ECDSA)</a>).</p>
</div>
<div class="paragraph data-line-489">
<p>Par exemple, regardons à nouveau le paiement d&#8217;Alice au comptoir à café de Bob. Alice a effectué un paiement de 0,015 bitcoin à l&#8217;adresse Bitcoin du comptoir. Cette sortie de transaction aurait un script de verrouillage de la forme :</p>
</div>
<div class="listingblock data-line-491">
<div class="content">
<pre>OP_DUP OP_HASH160 &lt;Cafe Public Key Hash&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-495">
<p>Le Cafe Public Key Hash équivaut à l&#8217;adresse Bitcoin du café, sans l&#8217;encodage Base58Check. La plupart des applications afficheraient le <em>hachage de la clé publique</em> en codage hexadécimal et non le format familier de l&#8217;adresse Bitcoin Base58Check qui commence par un &quot;1&quot;.</p>
</div>
<div class="paragraph data-line-497">
<p>Le script de verrouillage précédent peut se contenter d&#8217;un script de déverrouillage de la forme :</p>
</div>
<div class="listingblock data-line-499">
<div class="content">
<pre>&lt;Cafe Signature&gt; &lt;Cafe Public Key&gt;</pre>
</div>
</div>
<div class="paragraph data-line-503">
<p>Les deux scripts ensemble formeraient le script de validation combiné suivant :</p>
</div>
<div class="listingblock data-line-505">
<div class="content">
<pre>&lt;Cafe Signature&gt; &lt;Cafe Public Key&gt; OP_DUP OP_HASH160
&lt;Cafe Public Key Hash&gt; OP_EQUALVERIFY OP_CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-510">
<p>Lorsqu&#8217;il est exécuté, ce script combiné sera évalué à TRUE si, et seulement si, le script de déverrouillage correspond aux conditions définies par le script de verrouillage. En d&#8217;autres termes, le résultat sera VRAI si le script de déverrouillage a une signature valide de la clé privée du comptoir qui correspond au hachage de la clé publique défini comme encombrement.</p>
</div>
<div class="paragraph data-line-512">
<p>Les figures <a data-type="xref" href="#P2PubKHash1" data-xrefstyle="select: labelnumber">#P2PubKHash1</a> et <a data-type="xref" href="#P2PubKHash2" data-xrefstyle="select: labelnumber">#P2PubKHash2</a> montrent (en deux parties) une exécution pas à pas du script combiné, qui prouvera qu&#8217;il s&#8217;agit d&#8217;une transaction valide.</p>
</div>
<div id="P2PubKHash1" class="imageblock data-line-516">
<div class="content">
<img src="images/mbc2_0605.png" alt="Tx_Script_P2PubKeyHash_1">
</div>
<div class="title">Figure 6. Évaluer un script pour une transaction P2PKH (partie 1 sur 2)</div>
</div>
<div id="P2PubKHash2" class="imageblock data-line-520">
<div class="content">
<img src="images/mbc2_0606.png" alt="Tx_Script_P2PubKeyHash_2">
</div>
<div class="title">Figure 7. Évaluer un script pour une transaction P2PKH (partie 2 sur 2)</div>
</div>
</div>
</div>
<div class="sect2 data-line-523">
<h3 id="digital_sigs">Signatures numériques (ECDSA)</h3>
<div class="paragraph data-line-525">
<p>Jusqu&#8217;à présent, nous n&#8217;avons approfondi aucun détail sur les &quot;signatures numériques&quot;. Dans cette section, nous examinons le fonctionnement des signatures numériques et comment elles peuvent présenter la preuve de la propriété d&#8217;une clé privée sans révéler cette clé privée.</p>
</div>
<div class="paragraph data-line-527">
<p>L&#8217;algorithme de signature numérique utilisé dans le bitcoin est l'<em>Elliptic Curve Digital Signature Algorithm</em>, ou <em>ECDSA</em>. ECDSA est l&#8217;algorithme utilisé pour les signatures numériques basées sur des paires de clés privées/publiques à courbe elliptique, comme décrit dans <a href="#elliptic_curve">[elliptic_curve]</a>. ECDSA est utilisé par les fonctions de script OP_CHECKSIG, OP_CHECKSIGVERIFY, OP_CHECKMULTISIG et OP_CHECKMULTISIGVERIFY. Chaque fois que vous les voyez dans un script de verrouillage, le script de déverrouillage doit contenir une signature ECDSA.</p>
</div>
<div class="paragraph data-line-529">
<p> Une signature numérique a trois objectifs en bitcoin. Premièrement, la signature prouve que le propriétaire de la clé privée, qui est implicitement le propriétaire des fonds, a <em>autorisé</em> la dépense de ces fonds. Deuxièmement, la preuve de l&#8217;autorisation est <em>indéniable</em> (non-répudiable). Troisièmement, la signature prouve que la transaction (ou des parties spécifiques de la transaction) n&#8217;a pas et <em>ne peut pas être modifiée</em> par qui que ce soit après avoir été signée.</p>
</div>
<div class="paragraph data-line-531">
<p>Notez que chaque entrée de transaction est signée indépendamment. Ceci est essentiel, car ni les signatures ni les entrées ne doivent appartenir ou être appliquées par les mêmes &quot;propriétaires&quot;. En fait, un schéma de transaction spécifique appelé &quot;CoinJoin&quot; utilise ce fait pour créer des transactions multipartites pour la confidentialité.</p>
</div>
<div class="admonitionblock note data-line-534">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-535">
<p>Chaque entrée de transaction et toute signature qu&#8217;elle peut contenir est <em>complètement</em> indépendante de toute autre entrée ou signature. Plusieurs parties peuvent collaborer pour construire des transactions et signer une seule entrée chacune.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="digital_signature_definition" class="sidebarblock data-line-540">
<div class="content">
<div class="title">Définition de Wikipedia d&#8217;une &quot;signature numérique&quot;</div>
<div class="paragraph data-line-541">
<p>Une signature numérique est un schéma mathématique permettant de démontrer l&#8217;authenticité d&#8217;un message ou de documents numériques. Une signature numérique valide donne au destinataire des raisons de croire que le message a été créé par un expéditeur connu (authentification), que l&#8217;expéditeur ne peut pas nier avoir envoyé le message (non-répudiable) et que le message n&#8217;a pas été altéré en transit (intégrité).</p>
</div>
<div class="paragraph data-line-543">
<p><em>Source: <a href="https://en.wikipedia.org/wiki/Digital_signature" class="undefined" data-href="https://en.wikipedia.org/wiki/Digital_signature">https://en.wikipedia.org/wiki/Digital_signature</a></em></p>
</div>
</div>
</div>
<div class="sect3 data-line-546">
<h4 id="_comment_fonctionnent_les_signatures_numériques">Comment fonctionnent les signatures numériques</h4>
<div class="paragraph data-line-548">
<p>Une signature numérique est un <em>schéma mathématique</em> qui se compose de deux parties. La première partie est un algorithme de création d&#8217;une signature, à l&#8217;aide d&#8217;une clé privée (la clé de signature), à partir d&#8217;un message (la transaction). La deuxième partie est un algorithme qui permet à quiconque de vérifier la signature, étant donné également le message et une clé publique.</p>
</div>
<div class="sect4 data-line-550">
<h5 id="_création_dune_signature_numérique">Création d&#8217;une signature numérique</h5>
<div class="paragraph data-line-552">
<p>Dans l&#8217;implémentation de l&#8217;algorithme ECDSA par bitcoin, le &quot;message&quot; signé est la transaction, ou plus précisément un hachage d&#8217;un sous-ensemble spécifique des données de la transaction (voir <a href="#sighash_types">Types de hachage de signature (SIGHASH)</a>). La clé de signature est la clé privée de l&#8217;utilisateur. Le résultat est la signature :</p>
</div>
<div class="paragraph data-line-554">
<p>\(\(Sig = F_{sig}(F_{hash}(m), dA)\)\)</p>
</div>
<div class="paragraph data-line-556">
<p>où:</p>
</div>
<div class="ulist data-line-558">
<ul>
<li class="data-line-558">
<p><em>dA</em> est la clé privée de signature</p>
</li>
<li class="data-line-559">
<p><em>m</em> est la transaction (ou une partie de celle-ci)</p>
</li>
<li class="data-line-560">
<p><em>F</em><sub><em>hash</em></sub> est la fonction de hachage</p>
</li>
<li class="data-line-561">
<p><em>F</em><sub><em>sig</em></sub> est l&#8217;algorithme de signature</p>
</li>
<li class="data-line-562">
<p><em>Sig</em> est la signature résultante</p>
</li>
</ul>
</div>
<div class="paragraph data-line-564">
<p>Plus de détails sur les mathématiques d&#8217;ECDSA peuvent être trouvés dans <a href="#ecdsa_math">Mathématiques ECDSA</a>.</p>
</div>
<div class="paragraph data-line-566">
<p>La fonction <em>F</em><sub><em>sig</em></sub> produit une signature Sig composée de deux valeurs, communément appelées R et S :</p>
</div>
<div class="listingblock data-line-568">
<div class="content">
<pre>Sig = (R, S)</pre>
</div>
</div>
<div class="paragraph data-line-572">
<p> Maintenant que les deux valeurs R et S ont été calculées, elles sont sérialisées en un flux d&#8217;octets à l&#8217;aide d&#8217;un schéma de codage standard international appelé <em>Distinguished Encoding Rules</em>, ou <em>DER</em> (ou règles d&#8217;encodage distingués).</p>
</div>
</div>
<div class="sect4 data-line-575">
<h5 id="seralization_of_signatures_der">Sérialisation des signatures (DER)</h5>
<div class="paragraph data-line-577">
<p>Regardons la transaction Alice créée à nouveau. Dans l&#8217;entrée de transaction, il y a un script de déverrouillage qui contient la signature encodée DER suivante du portefeuille d&#8217;Alice :</p>
</div>
<div class="listingblock data-line-579">
<div class="content">
<pre>3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e38133</pre>
</div>
</div>
<div class="paragraph data-line-583">
<p>Cette signature est un flux d&#8217;octets sérialisé des valeurs R et S produites par le portefeuille d&#8217;Alice pour prouver qu&#8217;elle possède la clé privée autorisée à dépenser cette sortie. Le format de sérialisation se compose de neuf éléments comme suit :</p>
</div>
<div class="ulist data-line-585">
<ul>
<li class="data-line-585">
<p>0x30—indiquant le début d&#8217;une séquence DER</p>
</li>
<li class="data-line-586">
<p>0x45—la longueur de la séquence (69 octets)</p>
</li>
<li class="data-line-587">
<p>0x02—une valeur entière suit</p>
</li>
<li class="data-line-588">
<p>0x21—la longueur de l&#8217;entier (33 octets)</p>
</li>
<li class="data-line-589">
<p>R—00884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb</p>
</li>
<li class="data-line-590">
<p>0x02—un autre entier suit</p>
</li>
<li class="data-line-591">
<p>0x20—la longueur de l&#8217;entier (32 octets)</p>
</li>
<li class="data-line-592">
<p>S—4b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</p>
</li>
<li class="data-line-593">
<p>Un suffixe (0x01) indiquant le type de hachage utilisé (SIGHASH_ALL)</p>
</li>
</ul>
</div>
<div class="paragraph data-line-595">
<p>Voyez si vous pouvez décoder la signature sérialisée (encodée en DER) d&#8217;Alice en utilisant cette liste. Les nombres importants sont R et S ; le reste des données fait partie du schéma de codage DER.</p>
</div>
</div>
</div>
<div class="sect3 data-line-597">
<h4 id="_vérification_de_la_signature">Vérification de la signature</h4>
<div class="paragraph data-line-599">
<p>Pour vérifier la signature, il faut avoir la signature (R et S), la transaction sérialisée, et la clé publique (qui correspond à la clé privée utilisée pour créer la signature). Essentiellement, la vérification d&#8217;une signature signifie &quot;Seul le propriétaire de la clé privée qui a généré cette clé publique pourrait avoir produit cette signature sur cette transaction.&quot;</p>
</div>
<div class="paragraph data-line-601">
<p>L&#8217;algorithme de vérification de signature prend le message (un hachage de la transaction ou de parties de celui-ci), la clé publique du signataire et la signature (valeurs R et S), et renvoie TRUE si la signature est valide pour ce message et cette clé publique.</p>
</div>
</div>
<div class="sect3 data-line-604">
<h4 id="sighash_types">Types de hachage de signature (SIGHASH)</h4>
<div class="paragraph data-line-606">
<p>Les signatures numériques sont appliquées aux messages, qui dans le cas du bitcoin, sont les transactions elles-mêmes. La signature implique un <em>engagement</em> du signataire sur des données de transaction spécifiques. Dans sa forme la plus simple, la signature s&#8217;applique à l&#8217;ensemble de la transaction, engageant ainsi toutes les entrées, sorties et autres champs de transaction. Cependant, une signature ne peut s&#8217;engager que sur un sous-ensemble des données d&#8217;une transaction, ce qui est utile pour un certain nombre de scénarios, comme nous le verrons dans cette section.</p>
</div>
<div class="paragraph data-line-608">
<p>Les signatures Bitcoin ont un moyen d&#8217;indiquer quelle partie des données d&#8217;une transaction est incluse dans le hachage signé par la clé privée à l&#8217;aide d&#8217;un drapeau SIGHASH. Le drapeau SIGHASH est un octet unique ajouté à la signature. Chaque signature a un drapeau SIGHASH et le drapeau peut être différent d&#8217;une entrée à l&#8217;autre. Une transaction avec trois entrées signées peut avoir trois signatures avec des drapeaux SIGHASH différents, chaque signature signant (committant) différentes parties de la transaction.</p>
</div>
<div class="paragraph data-line-610">
<p>N&#8217;oubliez pas que chaque entrée peut contenir une signature dans son script de déverrouillage. Par conséquent, une transaction qui contient plusieurs entrées peut avoir des signatures avec différents indicateurs SIGHASH qui valident différentes parties de la transaction dans chacune des entrées. Notez également que les transactions bitcoin peuvent contenir des entrées de différents &quot;propriétaires&quot;, qui ne peuvent signer qu&#8217;une seule entrée dans une transaction partiellement construite (et invalide), collaborant avec d&#8217;autres pour rassembler toutes les signatures nécessaires pour effectuer une transaction valide. De nombreux types d&#8217;indicateurs SIGHASH n&#8217;ont de sens que si vous pensez à plusieurs participants collaborant en dehors du réseau Bitcoin et mettant à jour une transaction partiellement signée.</p>
</div>
<div class="paragraph pagebreak-before data-line-613">
<p>Il existe trois indicateurs SIGHASH : ALL, NONE et SINGLE, comme indiqué dans <a href="#sighash_types_and_their">Types SIGHASH et leurs significations</a>.</p>
</div>
<table id="sighash_types_and_their" class="tableblock frame-all grid-all stretch data-line-618">
<caption class="title">Table 4. Types SIGHASH et leurs significations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drapeau SIGHASH</th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique à toutes les entrées et sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique à toutes les entrées, aucune des sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SINGLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique à toutes les entrées mais uniquement à la sortie avec le même numéro d&#8217;index que l&#8217;entrée signée</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-625">
<p>De plus, il existe un drapeau modificateur SIGHASH_ANYONECANPAY, qui peut être combiné avec chacun des drapeaux précédents. Lorsque ANYONECANPAY est défini, une seule entrée est signée, laissant le reste (et leurs numéros de séquence) ouverts pour modification. Le ANYONECANPAY a la valeur 0x80 et est appliqué par OR au niveau du bit, ce qui donne les drapeaux combinés comme indiqué dans <a href="#sighash_types_with_modifiers">Types SIGHASH avec modificateurs et leurs significations</a>.</p>
</div>
<table id="sighash_types_with_modifiers" class="tableblock frame-all grid-all stretch data-line-630">
<caption class="title">Table 5. Types SIGHASH avec modificateurs et leurs significations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drapeau SIGHASH</th>
<th class="tableblock halign-left valign-top">Valeur</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL|ANYONECANPAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique à une entrée et à toutes les sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NONE|ANYONECANPAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique à une entrée, aucune des sorties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SINGLE|ANYONECANPAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x83</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">La signature s&#8217;applique à une entrée et à la sortie avec le même numéro d&#8217;index</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-637">
<p>Ces combinaisons de drapeaux sont résumées dans <a href="#sighash_combinations">Résumé des différentes combinaisons de sighash</a>.</p>
</div>
<div id="sighash_combinations" class="imageblock data-line-641">
<div class="content">
<img src="images/sighash_combinations.png" alt="&quot;Résumé des différentes combinaisons de drapeaux SIGHASH&quot;">
</div>
<div class="title">Figure 8. Résumé des différentes combinaisons de sighash</div>
</div>
<div class="paragraph data-line-643">
<p>La façon dont les drapeaux SIGHASH sont appliqués lors de la signature et de la vérification est qu&#8217;une copie de la transaction est faite et que certains champs à l&#8217;intérieur sont tronqués (mis à zéro et vidés). La transaction résultante est sérialisée. Le drapeau SIGHASH est ajouté à la fin de la transaction sérialisée et le résultat est haché. Le hachage lui-même est le &quot;message&quot; qui est signé. Selon l&#8217;indicateur SIGHASH utilisé, différentes parties de la transaction sont tronquées. Le hachage résultant dépend de différents sous-ensembles de données dans la transaction. En incluant le SIGHASH comme dernière étape avant le hachage, la signature valide également le type SIGHASH, de sorte qu&#8217;il ne peut pas être modifié (par exemple, par un mineur).</p>
</div>
<div class="admonitionblock note data-line-646">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-647">
<p>Tous les types SIGHASH signent le champ nLocktime de la transaction (voir <a href="#transaction_locktime_nlocktime">[transaction_locktime_nlocktime]</a>). De plus, le type SIGHASH lui-même est ajouté à la transaction avant sa signature, de sorte qu&#8217;il ne peut pas être modifié une fois signé.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-650">
<p>Dans l&#8217;exemple de la transaction d&#8217;Alice (voir la liste dans <a href="#seralization_of_signatures_der">Sérialisation des signatures (DER)</a>), nous avons vu que la dernière partie de la signature codée en DER était 01, qui est le drapeau SIGHASH_ALL. Cela verrouille les données de transaction, de sorte que la signature d&#8217;Alice valide l&#8217;état de toutes les entrées et sorties. C&#8217;est la forme de signature la plus courante.</p>
</div>
<div class="paragraph data-line-652">
<p>Examinons quelques-uns des autres types de SIGHASH et comment ils peuvent être utilisés dans la pratique :</p>
</div>
<div class="dlist data-line-654">
<dl>
<dt class="hdlist1">ALL|ANYONECANPAY </dt>
<dd>
<p>Cette construction peut être utilisée pour effectuer une transaction de type &quot;financement participatif&quot;. les fonds peuvent construire une transaction avec une seule sortie. La sortie unique paie le montant &quot;objectif&quot; à la collecte de fonds. Une telle transaction n&#8217;est évidemment pas valide, car elle n&#8217;a pas d&#8217;entrées. Cependant, d&#8217;autres peuvent maintenant la modifier en ajoutant une entrée de leur propre, en tant que don. Ils signent leur propre entrée avec ALL|ANYONECANPAY. À moins que suffisamment d&#8217;entrées ne soient rassemblées pour atteindre la valeur de la sortie, la transaction n&#8217;est pas valide. Chaque don est un &quot;engagement&quot;, qui ne peut pas être collecté par le collecteur de fonds jusqu&#8217;à ce que le montant total de l&#8217;objectif soit atteint.</p>
</dd>
<dt class="hdlist1">NONE </dt>
<dd>
<p>Cette construction peut être utilisée pour créer un &quot;chèque au porteur&quot; ou un &quot;chèque en blanc&quot; d&#8217;un montant spécifique. Il s&#8217;engage sur l&#8217;entrée, mais permet de modifier le script de verrouillage de sortie. N&#8217;importe qui peut écrire sa propre adresse Bitcoin dans le script de verrouillage de sortie et racheter la transaction. Cependant, la valeur de sortie elle-même est verrouillée par la signature.</p>
</dd>
<dt class="hdlist1">NONE|ANYONECANPAY </dt>
<dd>
<p>Cette construction peut être utilisée pour construire un &quot;collecteur de poussière&quot;. Les utilisateurs qui ont de minuscules UTXO dans leur portefeuille ne peuvent pas les dépenser car le coût des frais dépasse la valeur de la poussière. Avec ce type de signature, la poussière UTXO peut être donnée à quiconque pour l&#8217;agréger et la dépenser quand il le souhaite.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-660">
<p>Il y a quelques propositions pour modifier ou étendre le système SIGHASH. L&#8217;une de ces propositions est <em>Bitmask Sighash Modes</em> de Glenn Willen de Blockstream, dans le cadre du projet Elements. Cela vise à créer un remplacement flexible pour les types SIGHASH qui permet &quot;des masques de bits arbitraires et réinscriptibles par des mineurs d&#8217;entrées et de sorties&quot; qui peuvent exprimer &quot;des schémas de pré-engagement contractuels plus complexes, tels que des offres signées avec changement dans un échange d&#8217;actifs distribué&quot;.</p>
</div>
<div class="admonitionblock note data-line-663">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-664">
<p>Vous ne verrez pas les drapeaux SIGHASH présentés comme une option dans l&#8217;application de portefeuille d&#8217;un utilisateur. À quelques exceptions près, les portefeuilles construisent des scripts P2PKH et signent avec les drapeaux SIGHASH_ALL. Pour utiliser un indicateur SIGHASH différent, vous devrez écrire un logiciel pour construire et signer des transactions. Plus important encore, les drapeaux SIGHASH peuvent être utilisés par des applications bitcoin à usage spécial qui permettent de nouvelles utilisations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-668">
<h4 id="ecdsa_math">Mathématiques ECDSA</h4>
<div class="paragraph data-line-670">
<p>Comme mentionné précédemment, les signatures sont créées par une fonction mathématique <em>F</em><sub><em>sig</em></sub> qui produit une signature composée de deux valeurs <em>R</em> et <em>S</em>. Dans cette section, nous examinons la fonction <em>F</em><sub><em>sig</em></sub> plus en détail.</p>
</div>
<div class="paragraph data-line-672">
<p>L&#8217;algorithme de signature génère d&#8217;abord une paire de clés publiques privées <em>éphémères</em> (temporaires). Cette paire de clés temporaire est utilisée dans le calcul des valeurs <em>R</em> et <em>S</em>, après une transformation impliquant la clé privée de signature et le hachage de la transaction.</p>
</div>
<div class="paragraph data-line-674">
<p>La paire de clés temporaire est basée sur un nombre aléatoire <em>k</em>, qui est utilisé comme clé privée temporaire. À partir de <em>k</em>, nous générons la clé publique temporaire correspondante <em>P</em> (calculée comme <em>P = k*G</em>, de la même manière que les clés publiques bitcoin sont dérivées ; voir <a href="#pubkey">[pubkey]</a>). La valeur <em>R</em> de la signature numérique est alors la coordonnée x de la clé publique éphémère <em>P</em>.</p>
</div>
<div class="paragraph data-line-676">
<p>A partir de là, l&#8217;algorithme calcule la valeur <em>S</em> de la signature, telle que :</p>
</div>
<div class="paragraph data-line-678">
<p><em>S</em> = <em>k</em><sup>-1</sup> (<em>Hash</em>(<em>m</em>) + <em>dA</em> * <em>R</em>) <em>mod n</em></p>
</div>
<div class="paragraph data-line-680">
<p>où:</p>
</div>
<div class="ulist data-line-682">
<ul>
<li class="data-line-682">
<p><em>k</em> est la clé privée éphémère</p>
</li>
<li class="data-line-683">
<p><em>R</em> est la coordonnée x de la clé publique éphémère</p>
</li>
<li class="data-line-684">
<p><em>dA</em> est la clé privée de signature</p>
</li>
<li class="data-line-685">
<p><em>m</em> est les données de transaction</p>
</li>
<li class="data-line-686">
<p><em>n</em> est l&#8217;ordre premier de la courbe elliptique</p>
</li>
</ul>
</div>
<div class="paragraph data-line-688">
<p>La vérification est l&#8217;inverse de la fonction de génération de signature, utilisant les valeurs <em>R</em>, <em>S</em> et la clé publique pour calculer une valeur <em>P</em>, qui est un point sur la courbe elliptique (la clé publique éphémère utilisée dans la création de signature) :</p>
</div>
<div class="paragraph data-line-690">
<p><em>P</em> = <em>S</em><sup>-1</sup> * <em>Hash</em>(<em>m</em>) * <em>G</em> + <em>S</em><sup>-1</sup> * <em>R</em> * <em>Qa</em></p>
</div>
<div class="paragraph data-line-692">
<p>où:</p>
</div>
<div class="ulist data-line-694">
<ul>
<li class="data-line-694">
<p><em>R</em> et <em>S</em> sont les valeurs de signature</p>
</li>
<li class="data-line-695">
<p><em>Qa</em> est la clé publique d&#8217;Alice</p>
</li>
<li class="data-line-696">
<p><em>m</em> est les données de transaction qui ont été signées</p>
</li>
<li class="data-line-697">
<p><em>G</em> est le point générateur de la courbe elliptique</p>
</li>
</ul>
</div>
<div class="paragraph data-line-699">
<p>Si la coordonnée x du point calculé <em>P</em> est égale à <em>R</em>, alors le vérificateur peut conclure que la signature est valide.</p>
</div>
<div class="paragraph data-line-701">
<p>Notez qu&#8217;en vérifiant la signature, la clé privée n&#8217;est ni connue ni révélée.</p>
</div>
<div class="admonitionblock tip data-line-704">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph data-line-705">
<p>ECDSA est nécessairement un calcul assez compliqué; une explication complète est au-delà de la portée de ce livre. Un certain nombre d&#8217;excellents guides en ligne vous guident étape par étape : recherchez &quot;ECDSA expliqué&quot; ou essayez celui-ci : <a href="https://bit.ly/2r0HhGB" class="undefined" data-href="https://bit.ly/2r0HhGB">https://bit.ly/2r0HhGB</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-708">
<h4 id="_limportance_du_caractère_aléatoire_dans_les_signatures">L&#8217;importance du caractère aléatoire dans les signatures</h4>
<div class="paragraph data-line-710">
<p>Comme nous l&#8217;avons vu dans <a href="#ecdsa_math">Mathématiques ECDSA</a>, l&#8217;algorithme de génération de signature utilise une clé aléatoire <em>k</em>, comme base d&#8217;un couple clé privée/publique éphémère. La valeur de <em>k</em> n&#8217;est pas importante, <em>tant qu&#8217;elle est aléatoire</em>. Si la même valeur <em>k</em> est utilisée pour produire deux signatures sur différents messages (transactions), alors la signature <em>clé privée</em> peut être calculée par n&#8217;importe qui. La réutilisation de la même valeur pour <em>k</em> dans un algorithme de signature conduit à l&#8217;exposition de la clé privée !</p>
</div>
<div class="admonitionblock warning data-line-713">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph data-line-714">
<p>Si la même valeur <em>k</em> est utilisée dans l&#8217;algorithme de signature sur deux transactions différentes, la clé privée peut être calculée et exposée au monde !</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph data-line-717">
<p>Ce n&#8217;est pas seulement une possibilité théorique. Nous avons vu ce problème conduire à l&#8217;exposition de clés privées dans quelques implémentations différentes d&#8217;algorithmes de signature de transaction en bitcoin. Des personnes se sont fait voler des fonds en raison de la réutilisation par inadvertance d&#8217;une valeur <em>k</em>. La raison la plus courante de réutilisation d&#8217;une valeur <em>k</em> est un générateur de nombres aléatoires mal initialisé.</p>
</div>
<div class="paragraph data-line-719">
<p>Pour éviter cette vulnérabilité, la meilleure pratique de l&#8217;industrie est de ne pas générer <em>k</em> avec un générateur de nombres aléatoires semé d&#8217;entropie, mais plutôt d&#8217;utiliser un processus déterministe-aléatoire semé avec les données de transaction elles-mêmes. Cela garantit que chaque transaction produit un <em>k</em> différent. L&#8217;algorithme standard de l&#8217;industrie pour l&#8217;initialisation déterministe de <em>k</em> est défini dans <a href="https://tools.ietf.org/html/rfc6979" data-href="https://tools.ietf.org/html/rfc6979">RFC 6979</a>, publié par l&#8217;Internet Engineering Task Force.</p>
</div>
<div class="paragraph data-line-721">
<p>Si vous implémentez un algorithme pour signer des transactions en bitcoin, vous <em>devez</em> utiliser la RFC 6979 ou un algorithme déterministe-aléatoire similaire pour vous assurer de générer un <em>k</em> différent pour chaque transaction.</p>
</div>
</div>
</div>
<div class="sect2 data-line-723">
<h3 id="_adresses_bitcoin_soldes_et_autres_abstractions">Adresses Bitcoin, soldes et autres abstractions</h3>
<div class="paragraph data-line-725">
<p>Nous avons commencé ce chapitre avec la découverte que les transactions sont très différentes &quot;dans les coulisses&quot; de la façon dont elles sont présentées dans les portefeuilles, les explorateurs de chaîne de blocs, et d&#8217;autres applications destinées aux utilisateurs. De nombreux concepts simplistes et familiers des chapitres précédents, tels que les adresses et les soldes Bitcoin, semblent être absents de la structure de transaction. Nous avons vu que les transactions ne contiennent pas d&#8217;adresses Bitcoin en soi, mais fonctionnent plutôt via des scripts qui verrouillent et déverrouillent des valeurs discrètes de bitcoin. Les soldes ne sont présents nulle part dans ce système et pourtant, chaque application de portefeuille affiche bien en évidence le solde du portefeuille de l&#8217;utilisateur.</p>
</div>
<div class="paragraph data-line-727">
<p>Maintenant que nous avons exploré ce qui est réellement inclus dans une transaction bitcoin, nous pouvons examiner comment les abstractions de niveau supérieur sont dérivées des composants apparemment primitifs de la transaction.</p>
</div>
<div class="paragraph data-line-729">
<p>Regardons à nouveau comment la transaction d&#8217;Alice a été présentée sur un explorateur de blocs populaire (<a href="#alice_transaction_to_bobs_cafe">Transaction d&#8217;Alice au Bob&#8217;s Café</a>).</p>
</div>
<div id="alice_transaction_to_bobs_cafe" class="imageblock data-line-733">
<div class="content">
<img src="images/mbc2_0208.png" alt="Alice Coffee Transaction">
</div>
<div class="title">Figure 9. Transaction d&#8217;Alice au Bob&#8217;s Café</div>
</div>
<div class="paragraph data-line-735">
<p>Sur le côté gauche de la transaction, l&#8217;explorateur de explorateur de chaîne de blocs affiche l&#8217;adresse Bitcoin d&#8217;Alice comme &quot;expéditeur&quot;. En fait, cette information n&#8217;est pas dans la transaction elle-même. Lorsque l&#8217;explorateur de blockchain fait référence à la transaction, il fait également référence à la transaction précédente associée à l&#8217;entrée et extrait la première sortie de cette transaction plus ancienne. Dans cette sortie se trouve un script de verrouillage qui verrouille l&#8217;UTXO sur le hachage de la clé publique d&#8217;Alice (un script P2PKH). L&#8217;explorateur de blockchain a extrait le hachage de la clé publique et l&#8217;a encodé à l&#8217;aide de l&#8217;encodage Base58Check pour produire et afficher l&#8217;adresse Bitcoin qui représente cette clé publique.</p>
</div>
<div class="paragraph data-line-737">
<p>De même, sur le côté droit, l&#8217;explorateur de blockchain affiche les deux sorties ; le premier à l&#8217;adresse Bitcoin de Bob et le second à l&#8217;adresse Bitcoin d&#8217;Alice (comme change). Encore une fois, pour créer ces adresses Bitcoin, l&#8217;explorateur de blockchain a extrait le script de verrouillage de chaque sortie, l&#8217;a reconnu comme un script P2PKH et a extrait le hachage de clé publique de l&#8217;intérieur. Enfin, l&#8217;explorateur de blockchain a réencodé chaque hachage de clé publique avec Base58Check pour produire et afficher les adresses Bitcoin.</p>
</div>
<div class="paragraph data-line-739">
<p>Si vous deviez cliquer sur l&#8217;adresse Bitcoin de Bob, l&#8217;explorateur de blockchain vous montrerait la vue dans <a href="#the_balance_of_bobs_bitcoin_address">Le solde de l&#8217;adresse Bitcoin de Bob</a>.</p>
</div>
<div id="the_balance_of_bobs_bitcoin_address" class="imageblock data-line-743">
<div class="content">
<img src="images/mbc2_0608.png" alt="&quot;Le solde de l&#8217;adresse Bitcoin de Bob&quot;">
</div>
<div class="title">Figure 10. Le solde de l&#8217;adresse Bitcoin de Bob</div>
</div>
<div class="paragraph data-line-745">
<p>L&#8217;explorateur de la chaîne de blocs affiche le solde de l&#8217;adresse Bitcoin de Bob. Mais nulle part dans le système Bitcoin il n&#8217;y a un concept de &quot;solde&quot;. Au lieu de cela, les valeurs affichées ici sont construites par l&#8217;explorateur de explorateur de chaîne de blocs comme suit.</p>
</div>
<div class="paragraph data-line-747">
<p>Pour construire le montant &quot;Total reçu&quot;, l&#8217;explorateur de explorateur de la chaîne de blocs décodera d&#8217;abord l&#8217;encodage Base58Check de l&#8217;adresse Bitcoin pour récupérer le hachage 160 bits de la clé publique de Bob qui est encodé dans l&#8217;adresse. Ensuite, l&#8217;explorateur de blockchain recherchera dans la base de données des transactions, à la recherche de sorties avec des scripts de verrouillage P2PKH contenant le hachage de la clé publique de Bob. En additionnant la valeur de toutes les sorties, l&#8217;explorateur de la chaîne de blocs peut produire la valeur totale reçue.</p>
</div>
<div class="paragraph data-line-749">
<p>Construire le solde actuel (affiché comme &quot;Solde final&quot;) nécessite un peu plus de travail. L&#8217;explorateur de la chaîne de blocs conserve une base de données distincte des sorties actuellement non dépensées, l&#8217;ensemble UTXO. Pour maintenir cette base de données, l&#8217;explorateur de la chaîne de blocs doit surveiller le réseau Bitcoin, ajouter les UTXO nouvellement créés et supprimer les UTXO dépensés, en temps réel, tels qu&#8217;ils apparaissent dans les transactions non confirmées. Il s&#8217;agit d&#8217;un processus compliqué qui dépend du suivi des transactions au fur et à mesure qu&#8217;elles se propagent, ainsi que du maintien d&#8217;un consensus avec le réseau Bitcoin pour s&#8217;assurer que la chaîne correcte est suivie. Parfois, l&#8217;explorateur de la chaîne de blocs est désynchronisé et sa perspective de l&#8217;ensemble UTXO est incomplète ou incorrecte.</p>
</div>
<div class="paragraph data-line-751">
<p>À partir de l&#8217;ensemble UTXO, l&#8217;explorateur de la chaîne de blocs résume la valeur de toutes les sorties non dépensées faisant référence au hachage de la clé publique de Bob et produit le numéro &quot;Solde final&quot; affiché à l&#8217;utilisateur.</p>
</div>
<div class="paragraph data-line-753">
<p>Afin de produire cette image unique, avec ces deux &quot;soldes&quot;, l&#8217;explorateur de la chaîne de blocs doit indexer et rechercher parmi des dizaines, des centaines, voire des centaines de milliers de transactions.</p>
</div>
<div class="paragraph data-line-755">
<p>En résumé, les informations présentées aux utilisateurs via les applications de portefeuille, les explorateurs de chaînes de blocs et d&#8217;autres interfaces utilisateur Bitcoin sont souvent composées d&#8217;abstractions de niveau supérieur qui sont dérivées en recherchant de nombreuses transactions différentes, en inspectant leur contenu et en manipulant les données qu&#8217;elles contiennent. En présentant cette vision simpliste des transactions bitcoin qui ressemblent à des chèques bancaires d&#8217;un expéditeur à un destinataire, ces applications doivent extraire de nombreux détails sous-jacents. Ils se concentrent principalement sur les types de transactions courants : P2PKH avec des signatures SIGHASH_ALL sur chaque entrée. Ainsi, alors que les applications bitcoin peuvent présenter plus de 80% de toutes les transactions de manière facile à lire, elles sont parfois bloquées par des transactions qui s&#8217;écartent de la norme. Les transactions qui contiennent des scripts de verrouillage plus complexes, ou différents indicateurs SIGHASH, ou de nombreuses entrées et sorties, démontrent la simplicité et la faiblesse de ces abstractions.</p>
</div>
<div class="paragraph data-line-757">
<p>Chaque jour, des centaines de transactions qui ne contiennent pas de sorties P2PKH sont confirmées sur la chaîne de blocs. Les explorateurs de chaîne de blocs les présentent souvent avec des messages d&#8217;avertissement rouges indiquant qu&#8217;ils ne peuvent pas décoder une adresse.</p>
</div>
<div class="paragraph data-line-759">
<p>Comme nous le verrons au chapitre suivant, il ne s&#8217;agit pas nécessairement de transactions étranges. Ce sont des transactions qui contiennent des scripts de verrouillage plus complexes que le P2PKH commun. Nous apprendrons ensuite à décoder et à comprendre des scripts plus complexes et les applications qu&#8217;ils prennent en charge.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-18 23:42:37 -0400
</div>
</div>
</body>
</html>