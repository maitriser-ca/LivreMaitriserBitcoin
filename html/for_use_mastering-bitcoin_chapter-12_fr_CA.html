<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Applications pour les chaînes de blocs</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-2">
<h2 id="ch12">Applications pour les chaînes de blocs</h2>
<div class="sectionbody">
<div class="paragraph data-line-4">
<p>Appuyons-nous maintenant sur notre compréhension du bitcoin en le considérant comme une <em>plate-forme d&#8217;application</em>. De nos jours, de nombreuses personnes utilisent le terme &quot;blockchain&quot; ou &quot;chaîne de blocs&quot; pour désigner toute plate-forme d&#8217;application qui partage les principes de conception du bitcoin. Le terme est souvent mal utilisé et appliqué à de nombreuses choses qui ne fournissent pas les principales fonctionnalités fournies par la chaîne de blocs de Bitcoin.</p>
</div>
<div class="paragraph data-line-6">
<p>Dans ce chapitre, nous examinerons les fonctionnalités offertes par la chaîne de blocs Bitcoin, en tant que plate-forme d&#8217;application. Nous considérerons les <em>primitives</em> de construction d&#8217;applications, qui forment les blocs de construction de toute application chaîne de blocs. Nous examinerons plusieurs applications importantes qui utilisent ces primitives, telles que les canaux de paiement (état) et les canaux de paiement routés (Lightning Network).</p>
</div>
<div class="sect2 data-line-8">
<h3 id="_présentation">Présentation</h3>
<div class="paragraph data-line-10">
<p>Le système Bitcoin a été conçu comme un système de monnaie et de paiement décentralisé. Cependant, la plupart de ses fonctionnalités sont dérivées de constructions de niveau beaucoup plus bas qui peuvent être utilisées pour des applications beaucoup plus larges. Bitcoin n&#8217;a pas été construit avec des composants tels que des comptes, des utilisateurs, des soldes et des paiements. Au lieu de cela, il utilise un langage de script transactionnel avec des fonctions cryptographiques de bas niveau, comme nous l&#8217;avons vu dans <a href="#transactions">[transactions]</a>. Tout comme les concepts de niveau supérieur des comptes, des soldes et des paiements peuvent être dérivés de ces primitives de base, il en va de même pour de nombreuses autres applications complexes. Ainsi, la chaîne de blocs Bitcoin peut devenir une plate-forme applicative offrant des services de confiance aux applications, tels que les contrats intelligents, dépassant de loin l&#8217;objectif initial de la monnaie numérique et des paiements.</p>
</div>
</div>
<div class="sect2 data-line-12">
<h3 id="_structures_de_base_les_primitives">Structures de base (les primitives)</h3>
<div class="paragraph data-line-14">
<p>Lorsqu&#8217;il fonctionne correctement et sur le long terme, le système Bitcoin offre certaines garanties, qui peuvent servir de structures de base pour créer des applications. Ceux-ci inclus:</p>
</div>
<div class="dlist data-line-16">
<dl>
<dt class="hdlist1">Pas de double dépense</dt>
<dd>
<p>La garantie la plus fondamentale de l&#8217;algorithme de consensus décentralisé de Bitcoin garantit qu&#8217;aucun UTXO ne peut être dépensé deux fois.</p>
</dd>
<dt class="hdlist1">Immuabilité</dt>
<dd>
<p>Une fois qu&#8217;une transaction est enregistrée dans la chaîne de blocs et que suffisamment de travail a été ajouté avec les blocs suivants, les données de la transaction deviennent immuables. L&#8217;immuabilité est garantie par l&#8217;énergie, car la réécriture de la chaîne de blocs nécessite une dépense d&#8217;énergie pour produire une preuve de travail. L&#8217;énergie requise et donc le degré d&#8217;immuabilité augmentent avec la quantité de travail engagé au-dessus du bloc contenant une transaction.</p>
</dd>
<dt class="hdlist1">Neutralité</dt>
<dd>
<p>Le réseau Bitcoin décentralisé propage des transactions valides quelle que soit l&#8217;origine ou le contenu de ces transactions. Cela signifie que n&#8217;importe qui peut créer une transaction valide avec des frais suffisants et être sûr qu&#8217;il sera en mesure de transmettre cette transaction et de l&#8217;inclure dans la chaîne de blocs à tout moment.</p>
</dd>
<dt class="hdlist1">Horodatage sécurisé</dt>
<dd>
<p>Les règles de consensus rejettent tout bloc dont l&#8217;horodatage est trop éloigné dans le passé ou dans le futur. Cela garantit que les horodatages sur les blocs sont fiables. L&#8217;horodatage sur un bloc implique une garantie non dépensée avant pour les entrées de toutes les transactions incluses.</p>
</dd>
<dt class="hdlist1">Autorisation</dt>
<dd>
<p>Les signatures numériques, validées dans un réseau décentralisé, offrent des garanties d&#8217;autorisation. Les scripts qui contiennent une exigence de signature numérique ne peuvent être exécutés sans l&#8217;autorisation du détenteur de la clé privée impliquée dans le script.</p>
</dd>
<dt class="hdlist1">Auditabilité</dt>
<dd>
<p>Toutes les transactions sont publiques et peuvent être auditées. Toutes les transactions et tous les blocs sont liés dans une chaîne ininterrompue jusqu&#8217;au bloc de genèse.</p>
</dd>
<dt class="hdlist1">Comptabilité</dt>
<dd>
<p>Dans toute transaction (à l&#8217;exception de la transaction coinbase), la valeur des entrées est égale à la valeur des sorties plus les frais. Il n&#8217;est pas possible de créer ou de détruire de la valeur bitcoin dans une transaction. Les sorties ne peuvent pas dépasser les entrées.</p>
</dd>
<dt class="hdlist1">Non-expiration</dt>
<dd>
<p>Une transaction valide n&#8217;expire pas. S&#8217;il est valable aujourd&#8217;hui, il le sera dans un avenir proche, tant que les intrants ne seront pas dépensés et que les règles de consensus ne changeront pas.</p>
</dd>
<dt class="hdlist1">Intégrité</dt>
<dd>
<p>Une transaction bitcoin signée avec SIGHASH_ALL ou des parties d&#8217;une transaction signée par un autre type SIGHASH ne peuvent pas être modifiées sans invalider la signature, invalidant ainsi la transaction elle-même.</p>
</dd>
<dt class="hdlist1">Atomicité des transactions</dt>
<dd>
<p>Les transactions Bitcoin sont atomiques. Ils sont valides et confirmés (minés) ou non. Les transactions partielles ne peuvent pas être extraites et il n&#8217;y a pas d&#8217;état intermédiaire pour une transaction. À tout moment, une transaction est minée ou non.</p>
</dd>
<dt class="hdlist1">Unités de valeur discrètes (indivisibles)</dt>
<dd>
<p>Les sorties de transaction sont des unités de valeur discrètes et indivisibles. Elles peuvent être dépensés ou non dépensés, en totalité. Elles ne peuvent pas être divisés ou partiellement dépensés.</p>
</dd>
<dt class="hdlist1">Quorum de contrôle</dt>
<dd>
<p>les contraintes de multisignature dans les scripts imposent un quorum d&#8217;autorisation, prédéfini dans le schéma de multisignature. L&#8217;exigence M-de-N est appliquée par les règles de consensus.</p>
</dd>
<dt class="hdlist1">Verrou temporel</dt>
<dd>
<p>Toute clause de script contenant un verrou temporel relatif ou absolu ne peut être exécutée qu&#8217;après que son âge dépasse le temps spécifié.</p>
</dd>
<dt class="hdlist1">Réplication</dt>
<dd>
<p>Le stockage décentralisé de la chaîne de blocs garantit que lorsqu&#8217;une transaction est extraite, après des confirmations suffisantes, elle est répliquée sur le réseau et devient durable et résistante aux coupures de courant, aux pertes de données, etc.</p>
</dd>
<dt class="hdlist1">Protection contre la falsification</dt>
<dd>
<p>Une transaction ne peut dépenser que des sorties existantes et validées. Il n&#8217;est pas possible de créer ou de contrefaire de la valeur.</p>
</dd>
<dt class="hdlist1">Cohérence</dt>
<dd>
<p>En l&#8217;absence de partitions de mineurs, les blocs enregistrés dans la chaîne de blocs sont sujets à une réorganisation ou à un désaccord avec une probabilité décroissante de manière exponentielle, en fonction de la profondeur à laquelle ils sont enregistrés. Une fois profondément enregistrés, le calcul et l&#8217;énergie nécessaires pour changer rendent le changement pratiquement irréalisable.</p>
</dd>
<dt class="hdlist1">Enregistrement de l&#8217;état externe</dt>
<dd>
<p>Une transaction peut valider une valeur de données, via OP_RETURN, représentant une transition d&#8217;état dans une machine à états externe.</p>
</dd>
<dt class="hdlist1">Émission prévisible</dt>
<dd>
<p>Moins de 21 millions de bitcoins seront émis, à un rythme prévisible.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-52">
<p>La liste des blocs de construction (ou structures de base) n&#8217;est pas complète et d&#8217;autres sont ajoutées à chaque nouvelle fonctionnalité introduite dans le bitcoin.</p>
</div>
</div>
<div class="sect2 data-line-54">
<h3 id="_applications_à_partir_des_structures_de_base">Applications à partir des structures de base</h3>
<div class="paragraph data-line-56">
<p>Les structures de base proposés par bitcoin sont des éléments d&#8217;une plateforme de confiance qui peuvent être utilisés pour composer des applications. Voici quelques exemples d&#8217;applications qui existent aujourd&#8217;hui et les blocs de construction qu&#8217;elles utilisent :</p>
</div>
<div class="dlist data-line-58">
<dl>
<dt class="hdlist1">Preuve d&#8217;existence (notaire numérique)</dt>
<dd>
<p>Immuabilité + Horodatage + Durabilité. Une empreinte numérique peut être validée avec une transaction dans la chaîne de blocs, prouvant qu&#8217;un document existait (horodatage) au moment où il a été enregistré. L&#8217;empreinte digitale ne pourra pas être modifiée ex-post-facto (Immutabilité) et la preuve sera conservée de façon permanente (Durabilité).</p>
</dd>
<dt class="hdlist1">Kickstarter (Lighthouse)</dt>
<dd>
<p>Cohérence + Atomicité + Intégrité. Si vous signez une entrée et la sortie (intégrité) d&#8217;une transaction de collecte de fonds, d&#8217;autres peuvent contribuer à la collecte de fonds mais elle ne peut pas être dépensée (atomicité) tant que l&#8217;objectif (valeur de sortie) n&#8217;est pas financé (cohérence).</p>
</dd>
<dt class="hdlist1">Canaux de paiement</dt>
<dd>
<p>Quorum de contrôle + Verrou temporel + Pas de double dépense + Non-expiration + Résistance à la censure + Autorisation. Un multisig 2-of-2 (Quorum) avec un verrou temporel (Verrou temporel) utilisé comme transaction de &quot;règlement&quot; d&#8217;un canal de paiement peut être détenu (Non-expiration) et dépensé à tout moment (Résistance à la censure) par l&#8217;une ou l&#8217;autre des parties (Autorisation). Les deux parties peuvent alors créer des transactions d&#8217;engagement qui doublent (Pas de double dépense) le règlement sur un verrou temporel plus court (Verrou temporel).</p>
</dd>
</dl>
</div>
</div>
<div class="sect2 data-line-64">
<h3 id="_counterparty">Counterparty</h3>
<div class="paragraph data-line-66">
<p>Conterparty est une couche de protocole construite au-dessus de bitcoin. Le protocole Counterparty offre la possibilité de créer et d&#8217;échanger des actifs virtuels et des jetons. De plus, Counterparty propose un échange décentralisé d&#8217;actifs. Conterparty met également en œuvre des contrats intelligents, basés sur la machine virtuelle Ethereum (EVM).</p>
</div>
<div class="paragraph data-line-68">
<p>Conterparty intègre des métadonnées dans les transactions bitcoin, en utilisant l&#8217;opcode OP_RETURN ou des adresses multisignatures 1 sur N qui encodent les métadonnées à la place des clés publiques. En utilisant ces mécanismes, Counterparty implémente une couche de protocole encodée dans les transactions bitcoin. La couche de protocole supplémentaire peut être interprétée par des applications compatibles avec Conterparty, telles que les portefeuilles et les explorateurs de chaînes de blocs, ou toute application construite à l&#8217;aide des bibliothèques de Conterparty.</p>
</div>
<div class="paragraph data-line-70">
<p>Conterparty peut être utilisée comme plate-forme pour d&#8217;autres applications et services, à leur tour. Par exemple, Tokenly est une plate-forme construite sur Counterparty qui permet aux créateurs de contenu, aux artistes et aux entreprises d&#8217;émettre des jetons qui expriment la propriété numérique et peuvent être utilisés pour louer, accéder, échanger ou acheter du contenu, des produits et des services. D&#8217;autres applications tirant parti de Counterparty incluent des jeux (Spells of Genesis) et des projets de grille informatique (Folding Coin).</p>
</div>
<div class="paragraph data-line-72">
<p>Plus de détails sur Counterparty peuvent être trouvés sur <a href="https://counterparty.io" class="undefined" data-href="https://counterparty.io">https://counterparty.io</a>. Le projet à source libre est disponible sur <a href="https://github.com/CounterpartyXCP" class="undefined" data-href="https://github.com/CounterpartyXCP">https://github.com/CounterpartyXCP</a>.</p>
</div>
</div>
<div class="sect2 data-line-75">
<h3 id="state_channels">Canaux de paiement et canaux d&#8217;état</h3>
<div class="paragraph data-line-77">
<p><em>Les canaux de paiement</em> sont un mécanisme sans confiance pour échanger des bitcoins transactions entre deux parties, en dehors de la chaîne de blocs Bitcoin. Ces transactions, qui seraient valides si elles étaient réglées sur la chaîne de blocs Bitcoin, sont plutôt détenues hors chaîne, agissant comme des <em>billets à ordre</em> pour un éventuel règlement par lots. Étant donné que les transactions ne sont pas réglées, elles peuvent être échangées sans la latence de règlement habituelle, ce qui permet un débit de transaction extrêmement élevé, une latence faible (inférieure à la milliseconde) et une granularité fine (niveau satoshi).</p>
</div>
<div class="paragraph data-line-79">
<p>En fait, le terme <em>canal</em> est une métaphore. Les canaux d&#8217;état sont des constructions virtuelles représentées par l&#8217;échange d&#8217;état entre deux parties, en dehors de la chaîne de blocs. Il n&#8217;y a pas de &quot;canaux&quot; en soi et le mécanisme de transport de données sous-jacent n&#8217;est pas le canal. Nous utilisons le terme canal pour représenter la relation et l&#8217;état partagé entre deux parties, en dehors de la chaîne de blocs.</p>
</div>
<div class="paragraph data-line-81">
<p>Pour expliquer davantage ce concept, pensez à un flux TCP. Du point de vue des protocoles de niveau supérieur, il s&#8217;agit d&#8217;une &quot;interface de connexion&quot; connectant deux applications sur Internet. Mais si vous regardez le trafic réseau, un flux TCP n&#8217;est qu&#8217;un canal virtuel sur des paquets IP. Chaque extrémité du flux TCP séquence et assemble les paquets IP pour créer l&#8217;illusion d&#8217;un flux d&#8217;octets. En dessous, ce sont tous les paquets déconnectés. De même, un canal de paiement n&#8217;est qu&#8217;une série de transactions. S&#8217;ils sont correctement séquencés et connectés, ils créent des obligations remboursables auxquelles vous pouvez faire confiance même si vous ne faites pas confiance à l&#8217;autre côté du canal.</p>
</div>
<div class="paragraph data-line-83">
<p>Dans cette section, nous examinerons différentes formes de canaux de paiement. Premièrement, nous examinerons les mécanismes utilisés pour construire un canal de paiement unidirectionnel (unidirectionnel) pour un service de micropaiement mesuré, tel que le streaming vidéo. Ensuite, nous développerons ce mécanisme et introduirons des canaux de paiement bidirectionnels. Enfin, nous verrons comment des canaux bidirectionnels peuvent être connectés de bout en bout pour former des canaux multisauts dans un réseau routé, d&#8217;abord proposé sous le nom de <em>Lightning Network</em>.</p>
</div>
<div class="paragraph data-line-85">
<p>Les canaux de paiement font partie du concept plus large d&#8217;un <em>canal d&#8217;état</em>, qui représente une altération d&#8217;état hors chaîne, sécurisée par un éventuel règlement dans une chaîne de blocs. Un canal de paiement est un canal d&#8217;état où l&#8217;état modifié est le solde d&#8217;une monnaie virtuelle.</p>
</div>
<div class="sect3 data-line-87">
<h4 id="_canaux_détat_concepts_de_base_et_terminologie">Canaux d&#8217;état, concepts de base et terminologie</h4>
<div class="paragraph data-line-89">
<p>Un canal d&#8217;état est établi entre deux parties, par le biais d&#8217;une transaction qui verrouille un état partagé sur la chaîne de blocs. C&#8217;est ce qu&#8217;on appelle la <em>transaction de financement</em> ou <em>transaction d&#8217;ancrage</em>. Cette transaction unique doit être transmise au réseau et exploitée pour établir le canal. Dans l&#8217;exemple d&#8217;un canal de paiement, l&#8217;état bloqué est le solde initial (en devise) du canal.</p>
</div>
<div class="paragraph data-line-91">
<p>Les deux parties échangent alors des transactions signées, appelées <em>transactions d&#8217;engagement</em>, qui modifient l&#8217;état initial. Ces transactions sont des transactions valides dans la mesure où elles <em>pourraient</em> être soumises pour règlement par l&#8217;une ou l&#8217;autre des parties, mais sont plutôt détenues hors chaîne par chaque partie en attendant la fermeture du canal. Les mises à jour d&#8217;état peuvent être créées aussi rapidement que chaque partie peut créer, signer et transmettre une transaction à l&#8217;autre partie. En pratique, cela signifie que des milliers de transactions par seconde peuvent être échangées.</p>
</div>
<div class="paragraph data-line-93">
<p>Lors de l&#8217;échange de transactions d&#8217;engagement, les deux parties invalident également les états précédents, de sorte que la transaction d&#8217;engagement la plus récente est toujours la seule qui puisse être remboursée. Cela empêche l&#8217;une ou l&#8217;autre des parties de tricher en fermant unilatéralement le canal avec un état antérieur expiré qui lui est plus favorable que l&#8217;état actuel. Nous examinerons les différents mécanismes qui peuvent être utilisés pour invalider l&#8217;état antérieur dans la suite de ce chapitre.</p>
</div>
<div class="paragraph data-line-95">
<p>Enfin, le canal peut être fermé soit de manière coopérative, en soumettant une <em>transaction de règlement</em> finale à la chaîne de blocs, soit unilatéralement, par l&#8217;une ou l&#8217;autre des parties soumettant la dernière transaction d&#8217;engagement à la chaîne de blocs. Une option de fermeture unilatérale est nécessaire au cas où l&#8217;une des parties se déconnecte de manière inattendue. La transaction de règlement représente l&#8217;état final du canal et est réglée sur la chaîne de blocs.</p>
</div>
<div class="paragraph data-line-97">
<p>Pendant toute la durée de vie de la chaîne, seules deux transactions doivent être soumises pour minage sur la chaîne de blocs: les transactions de financement et de règlement. Entre ces deux états, les deux parties peuvent échanger un nombre illimité de transactions d&#8217;engagement qui ne sont jamais vues par personne d&#8217;autre, ni soumises à la chaîne de blocs.</p>
</div>
<div class="paragraph data-line-99">
<p><a href="#payment_channel">Un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de règlement</a> illustre un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de règlement.</p>
</div>
<div id="payment_channel" class="imageblock data-line-103">
<div class="content">
<img src="images/mbc2_1201.png" alt="&quot;Un canal de paiement entre Bob et Alice" width="montrant les transactions de financement" height="d'engagement et de règlement&quot;">
</div>
<div class="title">Figure 1. Un canal de paiement entre Bob et Alice, montrant les transactions de financement, d&#8217;engagement et de règlement</div>
</div>
</div>
<div class="sect3 data-line-105">
<h4 id="_exemple_de_canal_de_paiement_simple">Exemple de canal de paiement simple</h4>
<div class="paragraph data-line-107">
<p>Pour expliquer les canaux d&#8217;état, nous commençons par un exemple très simple. Nous démontrons un canal à sens unique, ce qui signifie que la valeur ne circule que dans une seule direction. Nous partirons également de l&#8217;hypothèse naïve que personne n&#8217;essaie de tricher, pour garder les choses simples. Une fois que nous aurons expliqué l&#8217;idée de base du canal, nous examinerons ce qu&#8217;il faut pour le rendre sans confiance afin qu&#8217;aucune des parties ne puisse tricher, même si elle essaie de le faire.</p>
</div>
<div class="paragraph data-line-109">
<p>Pour cet exemple, nous supposerons deux participants : Emma et Fabian. Fabian propose un service de diffusion vidéo en continu facturé à la seconde via un canal de micropaiement. Fabian facture 0,01 millibit (0,00001 BTC) par seconde de vidéo, ce qui équivaut à 36 millibits (0,036 BTC) par heure de vidéo. Emma est une utilisatrice qui achète ce service de diffusion vidéo en continu auprès de Fabian. <a href="#emma_fabian_streaming_video">Emma achète la vidéo en continu de Fabian avec un canal de paiement, payant pour chaque seconde de vidéo</a> montre Emma achetant le service de diffusion vidéo en continu de Fabian en utilisant un canal de paiement.</p>
</div>
<div id="emma_fabian_streaming_video" class="imageblock data-line-113">
<div class="content">
<img src="images/mbc2_1202.png" alt="&quot;Emma achète la diffusion vidéo en continu de Fabian avec un canal de paiement" width="payant pour chaque seconde de vidéo&quot;">
</div>
<div class="title">Figure 2. Emma achète la vidéo en continu de Fabian avec un canal de paiement, payant pour chaque seconde de vidéo</div>
</div>
<div class="paragraph data-line-115">
<p>Dans cet exemple, Fabian et Emma utilisent un logiciel spécial qui gère à la fois le canal de paiement et la diffusion vidéo en continu. Emma exécute le logiciel dans son navigateur, Fabian l&#8217;exécute sur un serveur. Le logiciel inclut les fonctionnalités de base du portefeuille bitcoin et peut créer et signer des transactions bitcoin. Le concept et le terme &quot;canal de paiement&quot; sont complètement cachés aux utilisateurs. Ce qu&#8217;ils voient, c&#8217;est une vidéo payée à la seconde.</p>
</div>
<div class="paragraph data-line-117">
<p>Pour mettre en place le canal de paiement, Emma et Fabian établissent une adresse multisignature 2 sur 2, chacun d&#8217;eux détenant l&#8217;une des clés. Du point de vue d&#8217;Emma, le logiciel de son navigateur présente un code QR avec une adresse P2SH (commençant par &quot;3&quot;) et lui demande de soumettre un &quot;dépôt&quot; pour jusqu&#8217;à 1 heure de vidéo. L&#8217;adresse est alors financée par Emma. La transaction d&#8217;Emma, payant à l&#8217;adresse multisignature, est la transaction de financement ou d&#8217;ancrage pour le canal de paiement.</p>
</div>
<div class="paragraph data-line-119">
<p>Pour cet exemple, disons qu&#8217;Emma finance la chaîne avec 36 millibits (0,036 BTC). Cela permettra à Emma de consommer <em>jusqu&#8217;à</em> 1 heure de diffusion vidéo en continu. La transaction de financement dans ce cas fixe le montant maximum qui peut être transmis dans ce canal, en définissant la <em>capacité du canal</em>.</p>
</div>
<div class="paragraph data-line-121">
<p>La transaction de financement consomme une ou plusieurs entrées du portefeuille d&#8217;Emma, approvisionnant les fonds. Il crée une sortie d&#8217;une valeur de 36 millibits payée à l&#8217;adresse multisignature 2 sur 2 contrôlée conjointement entre Emma et Fabian. Il peut avoir des sorties supplémentaires pour revenir au portefeuille d&#8217;Emma.</p>
</div>
<div class="paragraph data-line-123">
<p>Une fois la transaction de financement confirmée, Emma peut commencer à diffuser la vidéo. Le logiciel d&#8217;Emma crée et signe une transaction d&#8217;engagement qui modifie le solde du canal pour créditer 0,01 millibit à l&#8217;adresse de Fabian et rembourser 35,99 millibits à Emma. La transaction signée par Emma consomme la sortie de 36 millibits créée par la transaction de financement et crée deux sorties : une pour son remboursement, l&#8217;autre pour le paiement de Fabian. La transaction n&#8217;est que partiellement signée - elle nécessite deux signatures (2 sur 2), mais n&#8217;a que la signature d&#8217;Emma. Lorsque le serveur de Fabian reçoit cette transaction, il ajoute la deuxième signature (pour l&#8217;entrée 2 sur 2) et la renvoie à Emma avec 1 seconde de vidéo. Désormais, les deux parties ont une transaction d&#8217;engagement entièrement signée que l&#8217;une ou l&#8217;autre peut racheter, représentant le solde à jour correct du canal. Aucune des parties ne diffuse cette transaction sur le réseau.</p>
</div>
<div class="paragraph data-line-125">
<p>Au tour suivant, le logiciel d&#8217;Emma crée et signe une autre transaction d&#8217;engagement (engagement #2) qui consomme la <em>même</em> sortie 2 sur 2 de la transaction de financement. La seconde transaction d&#8217;engagement alloue une sortie de 0,02 millibits à l&#8217;adresse de Fabian et une sortie de 35,98 millibits à l&#8217;adresse d&#8217;Emma. Cette nouvelle transaction est le paiement de deux secondes cumulées de vidéo. Le logiciel de Fabian signe et renvoie la deuxième transaction d&#8217;engagement, ainsi qu&#8217;une autre seconde de vidéo.</p>
</div>
<div class="paragraph data-line-127">
<p>De cette manière, le logiciel d&#8217;Emma continue d&#8217;envoyer des transactions d&#8217;engagement au serveur de Fabian en échange de diffusion vidéo en continu. Le solde de la chaîne s&#8217;accumule progressivement en faveur de Fabian, car Emma consomme plus de secondes de vidéo. Disons qu&#8217;Emma regarde 600 secondes (10 minutes) de vidéo, créant et signant 600 transactions d&#8217;engagement. La dernière transaction d&#8217;engagement (#600) aura deux sorties, divisant le solde de la chaîne, 6 millibits pour Fabian et 30 millibits pour Emma.</p>
</div>
<div class="paragraph data-line-129">
<p>Enfin, Emma sélectionne &quot;Stop&quot; pour arrêter le streaming vidéo. Fabian ou Emma peuvent maintenant transmettre la transaction d&#8217;état finale pour règlement. Cette dernière transaction est la <em>transaction de règlement</em> et paie Fabian pour toute la vidéo consommée par Emma, remboursant le reste de la transaction de financement à Emma.</p>
</div>
<div class="paragraph data-line-131">
<p><a href="#video_payment_channel">Le canal de paiement d&#8217;Emma avec Fabian, montrant les transactions d&#8217;engagement qui mettent à jour le solde du canal</a> montre le canal entre Emma et Fabian et les transactions d&#8217;engagement qui mettent à jour le solde du canal.</p>
</div>
<div class="paragraph data-line-133">
<p>Au final, seules deux transactions sont enregistrées sur la chaîne de bocs: la transaction de financement qui établit le canal et une transaction de règlement qui répartit correctement le solde final entre les deux participants.</p>
</div>
<div id="video_payment_channel" class="imageblock data-line-137">
<div class="content">
<img src="images/mbc2_1203.png" alt="&quot;Le canal de paiement d&#8217;Emma avec Fabian" width="montrant les transactions d'engagement qui mettent à jour le solde du canal&quot;">
</div>
<div class="title">Figure 3. Le canal de paiement d&#8217;Emma avec Fabian, montrant les transactions d&#8217;engagement qui mettent à jour le solde du canal</div>
</div>
</div>
<div class="sect3 data-line-139">
<h4 id="_créer_des_canaux_sans_confiance">Créer des canaux sans confiance</h4>
<div class="paragraph data-line-141">
<p>Le canal que nous venons de décrire fonctionne, mais seulement si les deux parties coopèrent, sans échec ni tentative de tricherie. Examinons certains des scénarios qui cassent ce canal et voyons ce qui est nécessaire pour les réparer :</p>
</div>
<div class="ulist data-line-143">
<ul>
<li class="data-line-143">
<p>Une fois la transaction de financement effectuée, Emma a besoin de la signature de Fabian pour récupérer l&#8217;argent. Si Fabian disparaît, les fonds d&#8217;Emma sont enfermés dans un 2 sur 2 et effectivement perdus. Ce canal, tel que construit, entraîne une perte de fonds si l&#8217;une des parties se déconnecte avant qu&#8217;il y ait au moins une transaction d&#8217;engagement signée par les deux parties.</p>
</li>
<li class="data-line-145">
<p>Pendant que le canal est en cours d&#8217;exécution, Emma peut prendre n&#8217;importe laquelle des transactions d&#8217;engagement que Fabian a contresignées et en transmettre une à la chaîne de blocs. Pourquoi payer 600 secondes de vidéo, si elle peut transmettre la transaction d&#8217;engagement #1 et ne payer que 1 seconde de vidéo ? La chaîne échoue car Emma peut tricher en diffusant un engagement préalable qui est en sa faveur.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-147">
<p>Ces deux problèmes peuvent être résolus avec des verrous temporels. Voyons comment nous pourrions utiliser des verrous temporels au niveau des transactions (nLocktime).</p>
</div>
<div class="paragraph data-line-149">
<p>Emma ne peut pas risquer de financer un multisig 2 sur 2 à moins qu&#8217;elle n&#8217;ait un remboursement garanti. Pour résoudre ce problème, Emma construit les transactions de financement et de remboursement en même temps. Elle signe la transaction de financement mais ne la transmet à personne. Emma transmet uniquement la transaction de remboursement à Fabian et obtient sa signature.</p>
</div>
<div class="paragraph data-line-151">
<p>La transaction de remboursement agit comme la première transaction d&#8217;engagement et son verrou temporel établit la limite supérieure pour la durée de vie du canal. Dans ce cas, Emma pourrait définir le nLocktime sur 30 jours ou 4320 blocs dans le futur. Toutes les transactions d&#8217;engagement ultérieures doivent avoir un verrou temporel plus court, afin qu&#8217;elles puissent être remboursées avant la transaction de remboursement.</p>
</div>
<div class="paragraph data-line-153">
<p>Maintenant qu&#8217;Emma a une transaction de remboursement entièrement signée, elle peut transmettre en toute confiance la transaction de financement signée en sachant qu&#8217;elle pourra éventuellement, après l&#8217;expiration du délai, racheter la transaction de remboursement même si Fabian disparaît.</p>
</div>
<div class="paragraph data-line-155">
<p>Chaque transaction d&#8217;engagement que les parties échangent pendant la durée de vie du canal sera verrouillée dans le futur. Mais le délai sera légèrement plus court pour chaque engagement afin que l&#8217;engagement le plus récent puisse être remboursé avant l&#8217;engagement précédent qu&#8217;il invalide. En raison de nLockTime, aucune des parties ne peut propager avec succès l&#8217;une des transactions d&#8217;engagement jusqu&#8217;à l&#8217;expiration de leur verrouillage temporel. Si tout va bien, ils coopéreront et fermeront le canal gracieusement avec une transaction de règlement, rendant inutile la transmission d&#8217;une transaction d&#8217;engagement intermédiaire. Sinon, la transaction d&#8217;engagement la plus récente peut être propagée pour régler le compte et invalider toutes les transactions d&#8217;engagement précédentes.</p>
</div>
<div class="paragraph data-line-157">
<p>Par exemple, si la transaction d&#8217;engagement #1 est verrouillée dans le temps sur 4320 blocs à l&#8217;avenir, alors la transaction d&#8217;engagement #2 est verrouillée dans le temps sur 4319 blocs dans le futur. La transaction d&#8217;engagement #600 peut être dépensée 600 blocs avant que la transaction d&#8217;engagement #1 ne devienne valide.</p>
</div>
<div class="paragraph data-line-159">
<p><a href="#timelocked_commitments">Chaque engagement fixe un délai plus court, ce qui lui permet d&#8217;être dépensé avant que les engagements précédents ne deviennent valides</a> montre chaque transaction d&#8217;engagement définissant un verrou temporel plus court, lui permettant d&#8217;être dépensé avant que les engagements précédents ne deviennent valides.</p>
</div>
<div id="timelocked_commitments" class="imageblock data-line-163">
<div class="content">
<img src="images/mbc2_1204.png" alt="&quot;Chaque engagement fixe un délai plus court" width="ce qui lui permet d'être dépensé avant que les engagements précédents ne deviennent valides&quot;">
</div>
<div class="title">Figure 4. Chaque engagement fixe un délai plus court, ce qui lui permet d&#8217;être dépensé avant que les engagements précédents ne deviennent valides</div>
</div>
<div class="paragraph data-line-165">
<p>Chaque transaction d&#8217;engagement ultérieure doit avoir un verrou temporel plus court afin qu&#8217;elle puisse être diffusée avant ses prédécesseurs et avant la transaction de remboursement. La possibilité de diffuser un engagement plus tôt garantit qu&#8217;il sera en mesure de dépenser la sortie de financement et d&#8217;empêcher toute autre transaction d&#8217;engagement d&#8217;être remboursée en dépensant la sortie. Les garanties offertes par la chaîne de blocs Bitcoin, empêchant les doubles dépenses et appliquant des verrous temporels, permettent effectivement à chaque transaction d&#8217;engagement d&#8217;invalider ses prédécesseurs.</p>
</div>
<div class="paragraph data-line-167">
<p>Les canaux d&#8217;état utilisent des verrous temporels pour appliquer des contrats intelligents dans une dimension temporelle. Dans cet exemple, nous avons vu comment la dimension temporelle garantit que la transaction d&#8217;engagement la plus récente devient valide avant tout engagement antérieur. Ainsi, la transaction d&#8217;engagement la plus récente peut être transmise, dépensant les entrées et invalidant les transactions d&#8217;engagement précédentes. L&#8217;application de contrats intelligents avec des délais absolus protège contre la tricherie par l&#8217;une des parties. Cette implémentation n&#8217;a besoin de rien de plus que des verrous temporels absolus au niveau de la transaction (nLocktime). Ensuite, nous verrons comment les verrous temporels au niveau du script, CHECKLOCKTIMEVERIFY et CHECKSEQUENCEVERIFY, peuvent être utilisés pour construire des canaux d&#8217;état plus flexibles, utiles et sophistiqués.</p>
</div>
<div class="paragraph data-line-169">
<p>La première forme de canal de paiement unidirectionnel a été présentée sous la forme d&#8217;un prototype d&#8217;application de streaming vidéo en 2015 par une équipe de développeurs argentins.</p>
</div>
<div class="paragraph data-line-171">
<p>Les verrous temporels ne sont pas le seul moyen d&#8217;invalider les transactions d&#8217;engagement antérieures. Dans les sections suivantes, nous verrons comment une clé de révocation peut être utilisée pour obtenir le même résultat. Les verrous temporels sont efficaces mais ils ont deux inconvénients distincts. En établissant un verrou temporel maximal lors de la première ouverture du canal, ils limitent la durée de vie du canal. Pire, ils obligent les implémentations de canaux à trouver un équilibre entre autoriser des canaux à longue durée de vie et obliger l&#8217;un des participants à attendre très longtemps un remboursement en cas de fermeture prématurée. Par exemple, si vous autorisez le canal à rester ouvert pendant 30 jours, en réglant le délai de remboursement sur 30 jours, si l&#8217;une des parties disparaît immédiatement, l&#8217;autre partie doit attendre 30 jours pour un remboursement. Plus le point final est éloigné, plus le remboursement est éloigné.</p>
</div>
<div class="paragraph data-line-173">
<p>Le deuxième problème est que puisque chaque transaction d&#8217;engagement ultérieure doit décrémenter le verrouillage temporel, il existe une limite explicite sur le nombre de transactions d&#8217;engagement qui peuvent être échangées entre les parties. Par exemple, un canal de 30 jours, définissant un verrouillage temporel de 4320 blocs dans le futur, ne peut accepter que 4320 transactions d&#8217;engagement intermédiaires avant de devoir être clôturé. Il y a un danger à définir l&#8217;intervalle de transaction d&#8217;engagement de verrouillage de temps à 1 bloc. En définissant l&#8217;intervalle de verrouillage entre les transactions d&#8217;engagement sur 1 bloc, un développeur crée une charge très lourde pour les participants au canal qui doivent être vigilants, rester en ligne et regarder, et être prêts à transmettre la bonne transaction d&#8217;engagement à tout moment.</p>
</div>
<div class="paragraph data-line-175">
<p>Maintenant que nous comprenons comment les verrous temporels peuvent être utilisés pour invalider des engagements antérieurs, nous pouvons voir la différence entre fermer le canal de manière coopérative et le fermer unilatéralement en diffusant une transaction d&#8217;engagement. Toutes les transactions d&#8217;engagement sont verrouillées dans le temps, par conséquent, la diffusion d&#8217;une transaction d&#8217;engagement impliquera toujours d&#8217;attendre jusqu&#8217;à ce que le verrouillage ait expiré. Mais si les deux parties s&#8217;entendent sur le solde final et savent qu&#8217;elles détiennent toutes les deux des transactions d&#8217;engagement qui feront éventuellement de ce solde une réalité, elles peuvent construire une transaction de règlement sans verrou temporel représentant ce même solde. Dans une clôture coopérative, l&#8217;une ou l&#8217;autre des parties prend la transaction d&#8217;engagement la plus récente et construit une transaction de règlement qui est identique à tous points de vue, sauf qu&#8217;elle omet le verrou temporel. Les deux parties peuvent signer cette transaction de règlement en sachant qu&#8217;il n&#8217;y a aucun moyen de tricher et d&#8217;obtenir un solde plus favorable. En signant et en transmettant de manière coopérative la transaction de règlement, ils peuvent fermer le canal et racheter leur solde immédiatement. Dans le pire des cas, l&#8217;une des parties peut être mesquine, refuser de coopérer et forcer l&#8217;autre partie à conclure unilatéralement la transaction d&#8217;engagement la plus récente. Mais s&#8217;ils le font, ils doivent aussi attendre leurs fonds.</p>
</div>
</div>
<div class="sect3 data-line-177">
<h4 id="_engagements_révocables_asymétriques">Engagements révocables asymétriques</h4>
<div class="paragraph data-line-179">
<p>Une meilleure façon de gérer les états d&#8217;engagement antérieurs est de les révoquer explicitement. Cependant, ce n&#8217;est pas facile à réaliser. Une caractéristique clé du bitcoin est qu&#8217;une fois qu&#8217;une transaction est valide, elle reste valide et n&#8217;expire pas. La seule façon d&#8217;annuler une transaction est de doubler ses entrées avec une autre transaction avant qu&#8217;elle ne soit minée. C&#8217;est pourquoi nous avons utilisé des verrous temporels dans l&#8217;exemple de canal de paiement simple ci-dessus pour nous assurer que les engagements les plus récents pourraient être dépensés avant que les engagements plus anciens ne soient valides. Cependant, l&#8217;enchaînement des engagements dans le temps crée un certain nombre de contraintes qui rendent les canaux de paiement difficiles à utiliser.</p>
</div>
<div class="paragraph data-line-181">
<p>Même si une transaction ne peut pas être annulée, elle peut être construite de manière à rendre son utilisation indésirable. Pour ce faire, nous donnons à chaque partie une <em>clé de révocation</em> qui peut être utilisée pour punir l&#8217;autre partie si elle essaie de tricher. Ce mécanisme de révocation des opérations d&#8217;engagement préalable a été initialement proposé dans le cadre du Lightning Network.</p>
</div>
<div class="paragraph data-line-183">
<p>Pour expliquer les clés de révocation, nous allons construire un canal de paiement plus complexe entre deux échanges gérés par Hitesh et Irene. Hitesh et Irene gèrent respectivement des échanges de bitcoins en Inde et aux États-Unis. Les clients de l&#8217;échange indien d&#8217;Hitesh envoient souvent des paiements aux clients de l&#8217;échange américain d&#8217;Irene et vice versa. Actuellement, ces transactions se produisent sur la chaîne de blocs Bitcoin, mais cela signifie payer des frais et attendre plusieurs blocs pour les confirmations. La mise en place d&#8217;un canal de paiement entre les bourses réduira considérablement les coûts et accélérera le flux des transactions.</p>
</div>
<div class="paragraph data-line-185">
<p>Hitesh et Irene démarrent le canal en construisant en collaboration une transaction de financement, chacun finançant la chaîne avec 5 bitcoins.
Le solde initial est de 5 bitcoins pour Hitesh et de 5 bitcoins pour Irene. La transaction de financement verrouille l&#8217;état du canal dans un multisig 2 sur 2, comme dans l&#8217;exemple d&#8217;un canal simple.</p>
</div>
<div class="paragraph data-line-188">
<p>La transaction de financement peut avoir une ou plusieurs entrées de Hitesh (ajoutant jusqu&#8217;à 5 bitcoins ou plus) et une ou plusieurs entrées d&#8217;Irene (ajoutant jusqu&#8217;à 5 bitcoins ou plus). Les entrées doivent légèrement dépasser la capacité du canal afin de couvrir les frais de transaction. La transaction a une sortie qui verrouille les 10 bitcoins au total sur une adresse multisig 2 sur 2 contrôlée à la fois par Hitesh et Irene. La transaction de financement peut également avoir une ou plusieurs sorties rendant la monnaie à Hitesh et Irene si leurs entrées ont dépassé leur contribution de canal prévue. Il s&#8217;agit d&#8217;une transaction unique avec des entrées offertes et signées par deux parties. Il doit être construit en collaboration et signé par chaque partie avant d&#8217;être transmis.</p>
</div>
<div class="paragraph data-line-190">
<p>Maintenant, au lieu de créer une transaction d&#8217;engagement unique que les deux parties signent, Hitesh et Irene créent deux transactions d&#8217;engagement différentes qui sont <em>asymétriques</em>.</p>
</div>
<div class="paragraph data-line-192">
<p>Hitesh a une transaction d&#8217;engagement avec deux sorties. La première sortie paie à Irene les 5 bitcoins qui lui sont dus <em>immédiatement</em>. La deuxième sortie paie à Hitesh les 5 bitcoins qui lui sont dus, mais seulement après un verrou temporel de 1000 blocs. Les sorties de transaction ressemblent à ceci :</p>
</div>
<div class="listingblock data-line-194">
<div class="content">
<pre>Input: 2-of-2 funding output, signed by Irene

Output 0 &lt;5 bitcoin&gt;:
    &lt;Irene's Public Key&gt; CHECKSIG

Output 1 &lt;5 bitcoin&gt;:
    &lt;1000 blocks&gt;
    CHECKSEQUENCEVERIFY
    DROP
    &lt;Hitesh's Public Key&gt; CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-207">
<p>Irène a une transaction d&#8217;engagement différente avec deux sorties. La première sortie paie à Hitesh les 5 bitcoins qui lui sont dus immédiatement. La deuxième sortie paie à Irene les 5 bitcoins qui lui sont dus mais seulement après un verrou temporel de 1000 blocs. La transaction d&#8217;engagement qu&#8217;Irene détient (signée par Hitesh) ressemble à ceci :</p>
</div>
<div class="listingblock data-line-209">
<div class="content">
<pre>Input: 2-of-2 funding output, signed by Hitesh

Output 0 &lt;5 bitcoin&gt;:
    &lt;Hitesh's Public Key&gt; CHECKSIG

Output 1 &lt;5 bitcoin&gt;:
    &lt;1000 blocks&gt;
    CHECKSEQUENCEVERIFY
    DROP
    &lt;Irene's Public Key&gt; CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-222">
<p>De cette façon, chaque partie a une transaction d&#8217;engagement, dépensant la sortie de financement 2 sur 2. Cette entrée est signée par l'<em>autre</em> partie. À tout moment, la partie détenant la transaction peut également signer (remplir le 2 sur 2) et diffuser. Cependant, s&#8217;ils diffusent la transaction d&#8217;engagement, il paie immédiatement l&#8217;autre partie alors qu&#8217;elle doit attendre l&#8217;expiration d&#8217;un verrou temporel. En imposant un délai au remboursement de l&#8217;une des sorties, nous désavantageons légèrement chaque partie lorsqu&#8217;elle choisit de diffuser unilatéralement une opération d&#8217;engagement. Mais un délai ne suffit pas à lui seul à encourager une conduite équitable.</p>
</div>
<div class="paragraph data-line-224">
<p><a href="#asymmetric_commitments">Deux opérations d&#8217;engagement asymétriques avec paiement différé pour le titulaire de l&#8217;opération</a> montre deux opérations d&#8217;engagement asymétriques, où la sortie payant le titulaire de l&#8217;engagement est retardée.</p>
</div>
<div id="asymmetric_commitments" class="imageblock data-line-228">
<div class="content">
<img src="images/mbc2_1205.png" alt="&quot;Deux opérations d&#8217;engagement asymétriques avec retard de paiement pour le porteur de l&#8217;opération&quot;">
</div>
<div class="title">Figure 5. Deux opérations d&#8217;engagement asymétriques avec paiement différé pour le titulaire de l&#8217;opération</div>
</div>
<div class="paragraph data-line-230">
<p>Nous introduisons maintenant le dernier élément de ce schéma : une clé de révocation qui empêche un tricheur de diffuser un engagement expiré. La clé de révocation permet à la partie lésée de sanctionner le tricheur en prélevant tout le solde de la chaîne.</p>
</div>
<div class="paragraph data-line-232">
<p>La clé de révocation est composée de deux secrets, chacun généré indépendamment par chaque participant du canal. Il est similaire à un multisig 2 sur 2, mais construit à l&#8217;aide de l&#8217;arithmétique de la courbe elliptique, de sorte que les deux parties connaissent la clé publique de révocation mais que chaque partie ne connaît que la moitié de la clé secrète de révocation.</p>
</div>
<div class="paragraph data-line-234">
<p>À chaque tour, les deux parties révèlent leur moitié du secret de révocation à l&#8217;autre partie, donnant ainsi à l&#8217;autre partie (qui a maintenant les deux moitiés) les moyens de réclamer la sortie de pénalité si cette transaction révoquée est jamais diffusée.</p>
</div>
<div class="paragraph data-line-236">
<p>Chacune des transactions d&#8217;engagement a une sortie &quot;retardée&quot;. Le script de rachat pour cette sortie permet à une partie de la racheter après 1000 blocs, <em>ou</em> à l&#8217;autre partie de la racheter si elle a une clé de révocation, pénalisant la transmission d&#8217;un engagement révoqué.</p>
</div>
<div class="paragraph data-line-238">
<p>Ainsi, lorsque Hitesh crée une transaction d&#8217;engagement pour Irene à signer, il rend la deuxième sortie payable à lui-même après 1000 blocs, ou à la clé publique de révocation (dont il ne connaît que la moitié du secret). Hitesh construit cette transaction. Il ne révélera sa moitié du secret de révocation à Irène que lorsqu&#8217;il sera prêt à passer à un nouvel état de canal et qu&#8217;il voudra révoquer cet engagement.</p>
</div>
<div class="paragraph data-line-240">
<p>Le script de la deuxième sortie ressemble à ceci :</p>
</div>
<div class="listingblock data-line-242">
<div class="content">
<pre>Output 0 &lt;5 bitcoin&gt;:
    &lt;Irene's Public Key&gt; CHECKSIG

Output 1 &lt;5 bitcoin&gt;:
IF
# Sortie de pénalité de révocation
    &lt;Revocation Public Key&gt;
ELSE
    &lt;1000 blocks&gt;
    CHECKSEQUENCEVERIFY
    DROP
    &lt;Hitesh's Public Key&gt;
ENDIF
CHECKSIG</pre>
</div>
</div>
<div class="paragraph data-line-259">
<p>Irène peut signer cette transaction en toute confiance, car si elle est transmise, elle lui paiera immédiatement ce qui lui est dû. Hitesh détient la transaction, mais sait que s&#8217;il la transmet dans une fermeture de canal unilatérale, il devra attendre 1000 blocs pour être payé.</p>
</div>
<div class="paragraph data-line-261">
<p>Lorsque le canal passe à l&#8217;état suivant, Hitesh doit <em>révoquer</em> cette transaction d&#8217;engagement avant qu&#8217;Irene n&#8217;accepte de signer la prochaine transaction d&#8217;engagement. Pour cela, il lui suffit d&#8217;envoyer sa moitié de <em>clé de révocation</em> à Irène. Une fois qu&#8217;Irene a les deux moitiés de la clé secrète de révocation pour cet engagement, elle peut signer le prochain engagement en toute confiance. Elle sait que si Hitesh essaie de tricher en publiant l&#8217;engagement précédent, elle peut utiliser la clé de révocation pour racheter la sortie retardée de Hitesh. <em>Si Hitesh triche, Irene obtient les DEUX sorties</em>. Pendant ce temps, Hitesh n&#8217;a que la moitié du secret de révocation pour cette clé publique de révocation et ne peut pas racheter la sortie avant 1000 blocs. Irene pourra racheter la sortie et punir Hitesh avant que les 1000 blocs ne se soient écoulés.</p>
</div>
<div class="paragraph data-line-263">
<p>Le protocole de révocation est bilatéral, ce qui signifie qu&#8217;à chaque tour, à mesure que l&#8217;état du canal est avancé, les deux parties échangent de nouveaux engagements, échangent des secrets de révocation pour les engagements précédents et signent les nouvelles transactions d&#8217;engagement de l&#8217;autre. Au fur et à mesure qu&#8217;ils acceptent un nouvel état, ils rendent l&#8217;état antérieur inutilisable, en se donnant mutuellement les secrets de révocation nécessaires pour sanctionner toute tricherie.</p>
</div>
<div class="paragraph data-line-265">
<p>Regardons un exemple de la façon dont cela fonctionne. L&#8217;un des clients d&#8217;Irene souhaite envoyer 2 bitcoins à l&#8217;un des clients de Hitesh. Pour transmettre 2 bitcoins à travers le canal, Hitesh et Irene doivent faire avancer l&#8217;état du canal pour refléter le nouvel équilibre. Ils s&#8217;engageront dans un nouvel état (état numéro 2) où les 10 bitcoins de la chaîne sont divisés, 7 bitcoins pour Hitesh et 3 bitcoins pour Irene. Pour faire progresser l&#8217;état du canal, ils créeront chacun de nouvelles transactions d&#8217;engagement reflétant le nouveau solde du canal.</p>
</div>
<div class="paragraph data-line-267">
<p>Comme auparavant, ces transactions d&#8217;engagement sont asymétriques de sorte que la transaction d&#8217;engagement que chaque partie détient les oblige à attendre si ils la remboursent. Surtout, avant de signer de nouvelles transactions d&#8217;engagement, ils doivent d&#8217;abord échanger des clés de révocation pour invalider l&#8217;engagement précédent. Dans ce cas particulier, les intérêts de Hitesh sont alignés sur l&#8217;état réel de la chaîne et il n&#8217;a donc aucune raison de diffuser un état antérieur. Cependant, pour Irene, l&#8217;état numéro 1 lui laisse un solde plus élevé que l&#8217;état 2. Quand Irene donne à Hitesh la clé de révocation pour sa transaction d&#8217;engagement précédente (état numéro 1), elle révoque effectivement sa capacité à tirer profit de la régression du canal vers un précédent. état parce qu&#8217;avec la clé de révocation, Hitesh peut racheter sans délai les deux sorties de la transaction d&#8217;engagement précédente. Cela signifie que si Irene diffuse l&#8217;état antérieur, Hitesh peut exercer son droit de prendre toutes les sorties.</p>
</div>
<div class="paragraph data-line-269">
<p>Il est important de noter que la révocation ne se produit pas automatiquement. Alors que Hitesh a la capacité de punir Irene pour avoir triché, il doit surveiller la blockchain avec diligence pour détecter des signes de tricherie. S&#8217;il voit une diffusion d&#8217;une transaction d&#8217;engagement préalable, il dispose de 1000 blocs pour agir et utiliser la clé de révocation pour contrecarrer la tricherie d&#8217;Irène et la punir en prenant la totalité du solde, les 10 bitcoins.</p>
</div>
<div class="paragraph data-line-271">
<p>Les engagements révocables asymétriques avec blocages temporels relatifs (CSV) sont une bien meilleure façon de mettre en œuvre les canaux de paiement et une innovation très importante dans cette technologie. Avec cette construction, le canal peut rester ouvert indéfiniment et peut avoir des milliards de transactions d&#8217;engagement intermédiaires. Dans les implémentations prototypes de Lightning Network, l&#8217;état d&#8217;engagement est identifié par un index de 48 bits, permettant plus de 281 000 milliards (2,8 x 10<sup>14</sup>) de transitions d&#8217;état dans n&#8217;importe quel canal !</p>
</div>
</div>
<div class="sect3 data-line-273">
<h4 id="_contrats_de_verrouillage_du_temps_de_hachage_htlc">Contrats de verrouillage du temps de hachage (HTLC)</h4>
<div class="paragraph data-line-275">
<p>Les canaux de paiement peuvent être encore étendus avec un type spécial de contrat intelligent qui permet aux participants d&#8217;engager des fonds dans un secret remboursable, avec un délai d&#8217;expiration. Cette fonctionnalité est appelée <em>contrats de verrouillage du temps de hachage</em> (<em>Hash Time Lock Contract</em>), ou <em>HTLC</em>, et est utilisée à la fois dans les canaux de paiement bidirectionnels et routés.</p>
</div>
<div class="paragraph data-line-277">
<p>Expliquons d&#8217;abord la partie &quot;hachage&quot; du HTLC. Pour créer un HTLC, le destinataire prévu du paiement créera d&#8217;abord un R secret. Ils calculent ensuite le hash de ce secret H :</p>
</div>
<div class="listingblock data-line-279">
<div class="content">
<pre>H = Hachage(R)</pre>
</div>
</div>
<div class="paragraph data-line-283">
<p>Cela produit un hachage H qui peut être inclus dans le script de verrouillage d&#8217;une sortie. Celui qui connaît le secret peut l&#8217;utiliser pour racheter la sortie. Le secret R est également appelé <em>préimage</em> pour la fonction de hachage. La préimage est simplement la donnée utilisée comme entrée dans une fonction de hachage.</p>
</div>
<div class="paragraph data-line-285">
<p>La deuxième partie d&#8217;un HTLC est le composant &quot;verrou temporel&quot;. Si le secret n&#8217;est pas révélé, le payeur du HTLC peut obtenir un &quot;remboursement&quot; après un certain temps. Ceci est réalisé avec un verrouillage temporel absolu à l&#8217;aide de CHECKLOCKTIMEVERIFY.</p>
</div>
<div class="paragraph data-line-287">
<p>Le script implémentant un HTLC pourrait ressembler à ceci :</p>
</div>
<div class="listingblock data-line-289">
<div class="content">
<pre>IF
# Paiement si vous avez le secret R
    HASH160 &lt;H&gt; EQUALVERIFY
ELSE
# Remboursement après expiration du délai.
    &lt;locktime&gt; CHECKLOCKTIMEVERIFY DROP
    &lt;Payer Public Key&gt; CHECKSIG
ENDIF</pre>
</div>
</div>
<div class="paragraph data-line-300">
<p>Toute personne connaissant le secret R, qui, lorsqu&#8217;il est haché, est égal à H, peut racheter cette sortie en exerçant la première clause du flux IF.</p>
</div>
<div class="paragraph data-line-302">
<p>Si le secret n&#8217;est pas révélé et que le HTLC est réclamé, après un certain nombre de blocages, le payeur peut demander un remboursement en utilisant la deuxième clause du flux IF.</p>
</div>
<div class="paragraph data-line-304">
<p>Il s&#8217;agit d&#8217;une implémentation de base d&#8217;un HTLC. Ce type de HTLC peut être échangé par <em>toute personne</em> qui a le secret R. Un HTLC peut prendre de nombreuses formes différentes avec de légères variations dans le script. Par exemple, l&#8217;ajout d&#8217;un opérateur CHECKSIG et d&#8217;une clé publique dans la première clause limite le rachat du hachage à un destinataire nommé, qui doit également connaître le secret R.</p>
</div>
</div>
</div>
<div class="sect2 data-line-307">
<h3 id="lightning_network">Canaux de paiement routés (Lightning Network)</h3>
<div class="paragraph data-line-309">
<p> Le Lightning Network est un réseau routé proposé de canaux de paiement bidirectionnels connectés de bout en bout. Un tel réseau peut permettre à n&#8217;importe quel participant d&#8217;acheminer un paiement d&#8217;un canal à l&#8217;autre sans faire confiance à aucun des intermédiaires. Le Lightning Network était <a href="https://lightning.network/lightning-network-paper.pdf" data-href="https://lightning.network/lightning-network-paper.pdf">décrit pour la première fois par Joseph Poon et Thadeus Dryja en février 2015</a>, s&#8217;appuyant sur le concept de canaux de paiement tel que proposé et élaboré par de nombreux autres.</p>
</div>
<div class="paragraph data-line-311">
<p>Le &quot;Lightning Network&quot; fait référence à une conception spécifique pour un réseau de canaux de paiement routés, qui a maintenant été mis en œuvre par au moins cinq équipes de sources libres différentes. Les implémentations indépendantes sont coordonnées par un ensemble de normes d&#8217;interopérabilité décrites dans le <a href="https://bit.ly/2rBHeoL" data-href="https://bit.ly/2rBHeoL">document <em>Basics of Lightning Technology (BOLT)</em></a>.</p>
</div>
<div class="paragraph data-line-313">
<p>Des implémentations prototypes du Lightning Network ont été publiées par plusieurs équipes.</p>
</div>
<div class="paragraph data-line-315">
<p>Le Lightning Network est une possibilité de mise en place de canaux de paiement routés. Il existe plusieurs autres conceptions qui visent à atteindre des objectifs similaires, telles que Teechan et Tumblebit.</p>
</div>
<div class="sect3 data-line-317">
<h4 id="_exemple_de_réseau_lightning_de_base">Exemple de réseau Lightning de base</h4>
<div class="paragraph data-line-319">
<p> Voyons comment cela fonctionne.</p>
</div>
<div class="paragraph data-line-321">
<p>Dans cet exemple, nous avons cinq participants : Alice, Bob, Carol, Diana et Eric. Ces cinq participants ont ouvert des canaux de paiement entre eux, par paires. Alice a un canal de paiement avec Bob. Bob est connecté à Carol, Carol à Diana et Diana à Eric. Pour simplifier, supposons que chaque chaîne est financée avec 2 bitcoins par chaque participant, pour une capacité totale de 4 bitcoins dans chaque chaîne.</p>
</div>
<div class="paragraph data-line-323">
<p><a href="#lightning_network_fig">Une série de canaux de paiement bidirectionnels liés pour former un réseau Lightning qui peut acheminer un paiement d&#8217;Alice à Eric</a> montre cinq participants dans un Lightning Network, connectés par des canaux de paiement bidirectionnels qui peuvent être liés pour effectuer un paiement d&#8217;Alice à Eric (<a href="#lightning_network">Canaux de paiement routés (Lightning Network)</a>).</p>
</div>
<div id="lightning_network_fig" class="imageblock data-line-327">
<div class="content">
<img src="images/mbc2_1206.png" alt="&quot;Une série de canaux de paiement bidirectionnels liés pour former un Lightning Network&quot;">
</div>
<div class="title">Figure 6. Une série de canaux de paiement bidirectionnels liés pour former un réseau Lightning qui peut acheminer un paiement d&#8217;Alice à Eric</div>
</div>
<div class="paragraph data-line-329">
<p>Alice veut payer Eric 1 bitcoin. Cependant, Alice n&#8217;est pas connectée à Eric par un canal de paiement. La création d&#8217;un canal de paiement nécessite une transaction de financement, qui doit être engagée dans la chaîne de blocs Bitcoin. Alice ne veut pas ouvrir un nouveau canal de paiement et engager davantage de ses fonds. Y a-t-il un moyen de payer Eric, indirectement ?</p>
</div>
<div class="paragraph data-line-331">
<p><a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> montre le processus étape par étape d&#8217;acheminement d&#8217;un paiement d&#8217;Alice à Eric, à travers une série d&#8217;engagements HTLC sur les canaux de paiement reliant les participants.</p>
</div>
<div id="ln_payment_process" class="imageblock data-line-335">
<div class="content">
<img src="images/mbc2_1207.png" alt="&quot;Acheminement des paiements étape par étape via un réseau Lightning&quot;">
</div>
<div class="title">Figure 7. Acheminement des paiements étape par étape via un réseau Lightning</div>
</div>
<div class="paragraph data-line-337">
<p>Alice exécute un nœud Lightning Network (LN) qui assure le suivi de son canal de paiement vers Bob et a la capacité de découvrir des itinéraires entre les canaux de paiement. Le nœud LN d&#8217;Alice a également la capacité de se connecter via Internet au nœud LN d&#8217;Eric. Le nœud LN d&#8217;Eric crée un R secret à l&#8217;aide d&#8217;un générateur de nombres aléatoires. Le noeud d&#8217;Eric ne révèle ce secret à personne. Au lieu de cela, le nœud d&#8217;Eric calcule un hachage H du secret R et transmet ce hachage au nœud d&#8217;Alice (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 1).</p>
</div>
<div class="paragraph data-line-339">
<p>Maintenant, le nœud LN d&#8217;Alice construit une route entre le nœud LN d&#8217;Alice et le nœud LN d&#8217;Eric. L&#8217;algorithme de routage utilisé sera examiné plus en détail plus tard, mais pour l&#8217;instant supposons que le nœud d&#8217;Alice puisse trouver une route efficace.</p>
</div>
<div class="paragraph data-line-341">
<p>Le nœud d&#8217;Alice construit alors un HTLC, payable au hash H, avec un délai de remboursement de 10 blocs (bloc actuel + 10), pour un montant de 1,003 bitcoin (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 2). Le supplément de 0,003 sera utilisé pour compenser les nœuds intermédiaires pour leur participation à cette voie de paiement. Alice offre ce HTLC à Bob, déduisant 1,003 bitcoin de son solde de canal avec Bob et l&#8217;engageant sur le HTLC. Le HTLC a la signification suivante : <em>"Alice engage 1,003 de son solde de canal à payer à Bob si Bob connaît le secret, ou remboursé sur le solde d&#8217;Alice si 10 blocs s&#8217;écoulent.&quot;</em> Le solde de canal entre Alice et Bob est maintenant exprimé par des transactions d&#8217;engagement avec trois sorties : solde de 2 bitcoins à Bob, solde de 0,997 bitcoin à Alice, 1,003 bitcoin engagé dans le HTLC d&#8217;Alice. Le solde d&#8217;Alice est réduit du montant engagé dans le HTLC.</p>
</div>
<div class="paragraph data-line-343">
<p>Bob s&#8217;est maintenant engagé à ce que s&#8217;il parvient à obtenir le secret + R + dans les 10 prochains blocs, il puisse réclamer les 1,003 verrouillés par Alice. Avec cet engagement en main, le nœud de Bob construit un HTLC sur son canal de paiement avec Carol. Le HTLC de Bob engage 1,002 bitcoin dans le hachage H pendant 9 blocs, que Carol peut échanger si elle a le secret R (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 3). Bob sait que si Carol peut réclamer son HTLC, elle doit produire R. Si Bob a + R + dans neuf blocs, il peut l&#8217;utiliser pour lui réclamer le HTLC d&#8217;Alice. Il gagne également 0,001 bitcoin pour avoir engagé le solde de son canal pendant neuf blocs. Si Carol n&#8217;est pas en mesure de réclamer son HTLC et qu&#8217;il ne peut pas réclamer le HTLC d&#8217;Alice, tout revient aux soldes de canal précédents et personne n&#8217;est à perte. L&#8217;équilibre des canaux entre Bob et Carol est maintenant : 2 pour Carol, 0,998 pour Bob, 1,002 commis par Bob pour le HTLC.</p>
</div>
<div class="paragraph data-line-345">
<p>Carol s&#8217;est maintenant engagée à ce que si elle obtient R dans les neuf prochains blocs, elle puisse réclamer 1,002 bitcoin verrouillé par Bob. Elle peut désormais s&#8217;engager sur HTLC sur sa chaîne avec Diana. Elle engage un HTLC de 1.001 bitcoin au hachage H, pour huit blocs, que Diana peut racheter si elle a le secret R (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 4). Du point de vue de Carol, si cela fonctionne, elle est plus riche de 0,001 bitcoin et si ce n&#8217;est pas le cas, elle ne perd rien. Son HTLC à Diana n&#8217;est viable que si R est révélé, auquel cas elle peut réclamer le HTLC à Bob. L&#8217;équilibre des canaux entre Carol et Diana est désormais : 2 pour Diana, 0,999 pour Carol, 1,001 commis par Carol pour le HTLC.</p>
</div>
<div class="paragraph data-line-347">
<p>Enfin, Diana peut proposer un HTLC à Eric, engageant 1 bitcoin pour sept blocs à hacher H (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 5). L&#8217;équilibre des canaux entre Diana et Eric est maintenant : 2 à Eric, 1 à Diana, 1 commis par Diana au HTLC.</p>
</div>
<div class="paragraph data-line-349">
<p>Cependant, à ce saut dans la route, Eric <em>a</em> le secret R. Il peut donc prétendre au HTLC proposé par Diana. Il envoie R à Diana et réclame le 1 bitcoin, l&#8217;ajoutant au solde de son canal (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 6). L&#8217;équilibre des canaux est maintenant : 1 pour Diana, 3 pour Eric.</p>
</div>
<div class="paragraph data-line-351">
<p>Maintenant, Diana a un R secret. Par conséquent, elle peut désormais réclamer le HTLC à Carol. Diana transmet R à Carol et ajoute le bitcoin 1.001 au solde de son canal (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 7). Maintenant, l&#8217;équilibre des canaux entre Carol et Diana est : 0,999 pour Carol, 3,001 pour Diana. Diana a &quot;gagné&quot; 0,001 pour sa participation à cette voie de paiement.</p>
</div>
<div class="paragraph data-line-353">
<p>En revenant sur le parcours, le secret R permet à chaque participant de réclamer les HTLC restants. Carol réclame 1,002 à Bob, fixant le solde sur leur chaîne à : 0,998 à Bob, 3,002 à Carol (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 8). Enfin, Bob revendique le HTLC d&#8217;Alice (voir <a href="#ln_payment_process">Acheminement des paiements étape par étape via un réseau Lightning</a> étape 9). Leur solde de canaux est mis à jour comme suit : 0,997 pour Alice, 3,003 pour Bob.</p>
</div>
<div class="paragraph data-line-355">
<p>Alice a payé Eric 1 bitcoin sans ouvrir de chaîne à Eric. Aucune des parties intermédiaires de la voie de paiement n&#8217;avait à se faire confiance. Pour l&#8217;engagement à court terme de leurs fonds dans le canal, ils peuvent gagner une petite commission, le seul risque étant un léger retard de remboursement si le canal était fermé ou si le paiement acheminé échouait.</p>
</div>
</div>
<div class="sect3 data-line-357">
<h4 id="_transport_et_routage_du_lightning_network">Transport et routage du Lightning Network</h4>
<div class="paragraph data-line-359">
<p>Toutes les communications entre les nœuds LN sont cryptées point à point. De plus, les nœuds ont une clé publique à long terme qu&#8217;ils utilisent comme identifiant et pour s&#8217;authentifier les uns les autres.</p>
</div>
<div class="paragraph data-line-361">
<p>Chaque fois qu&#8217;un nœud souhaite envoyer un paiement à un autre nœud, il doit d&#8217;abord construire un <em>chemin</em> à travers le réseau en connectant des canaux de paiement avec une capacité suffisante. Les nœuds annoncent les informations de routage, y compris les canaux qu&#8217;ils ont ouverts, la capacité de chaque canal et les frais qu&#8217;ils facturent pour acheminer les paiements. Les informations de routage peuvent être partagées de diverses manières et différents protocoles de routage sont susceptibles d&#8217;émerger à mesure que la technologie Lightning Network progresse. Certaines implémentations de Lightning Network utilisent le protocole IRC comme mécanisme pratique permettant aux nœuds d&#8217;annoncer les informations de routage. Une autre implémentation de la découverte de route utilise un modèle P2P où les nœuds propagent les annonces de canal à leurs pairs, dans un modèle d'&quot;inondation&quot;, similaire à la façon dont bitcoin propage les transactions. Les plans futurs incluent une proposition appelée <a href="https://bit.ly/2r5TACm" data-href="https://bit.ly/2r5TACm">Flare</a>, qui est un modèle de routage hybride avec des &quot;quartiers&quot; de nœuds locaux et des nœuds de balise à plus longue portée.</p>
</div>
<div class="paragraph data-line-363">
<p>Dans notre exemple précédent, le nœud d&#8217;Alice utilise l&#8217;un de ces mécanismes de découverte de route pour trouver un ou plusieurs chemins reliant son nœud au nœud d&#8217;Eric. Une fois que le nœud d&#8217;Alice a construit un chemin, elle initialisera ce chemin à travers le réseau, en propageant une série d&#8217;instructions cryptées et imbriquées pour connecter chacun des canaux de paiement adjacents.</p>
</div>
<div class="paragraph data-line-365">
<p>Il est important de noter que ce chemin n&#8217;est connu que du nœud d&#8217;Alice. Tous les autres participants de la route de paiement ne voient que les nœuds adjacents. Du point de vue de Carol, cela ressemble à un paiement de Bob à Diana. Carol ne sait pas que Bob transmet en fait un paiement d&#8217;Alice. Elle ne sait pas non plus que Diana transmettra un paiement à Eric.</p>
</div>
<div class="paragraph data-line-367">
<p>Il s&#8217;agit d&#8217;une fonctionnalité essentielle du Lightning Network, car elle garantit la confidentialité des paiements et rend très difficile l&#8217;application de la surveillance, de la censure ou des listes noires. Mais comment Alice établit-elle ce chemin de paiement, sans rien révéler aux nœuds intermédiaires ?</p>
</div>
<div class="paragraph data-line-369">
<p>Le Lightning Network implémente un protocole de routage en oignon basé sur un schéma appelé <a href="https://bit.ly/2q6ZDrP" data-href="https://bit.ly/2q6ZDrP">Sphinx</a>. Ce protocole de routage garantit qu&#8217;un expéditeur de paiement peut construire et communiquer un chemin à travers le Lightning Network tel que :</p>
</div>
<div class="ulist data-line-371">
<ul>
<li class="data-line-371">
<p>Les nœuds intermédiaires peuvent vérifier et décrypter leur portion d&#8217;informations de route et trouver le saut suivant.</p>
</li>
<li class="data-line-373">
<p>À part les sauts précédents et suivants, ils ne peuvent pas en savoir plus sur les autres nœuds faisant partie du chemin.</p>
</li>
<li class="data-line-375">
<p>Ils ne peuvent pas identifier la longueur du chemin de paiement, ni leur propre position dans ce chemin.</p>
</li>
<li class="data-line-377">
<p>Chaque partie du chemin est cryptée de telle manière qu&#8217;un attaquant au niveau du réseau ne peut pas associer les paquets de différentes parties du chemin les uns aux autres.</p>
</li>
<li class="data-line-379">
<p>Contrairement à Tor (un protocole d&#8217;anonymisation routé par couches d&#8217;oignon sur Internet), il n&#8217;y a pas de &quot;nœuds de sortie&quot; qui peuvent être placés sous surveillance. Les paiements n&#8217;ont pas besoin d&#8217;être transmis à la chaîne de blocs Bitcoin ; les nœuds mettent simplement à jour les soldes des canaux.</p>
</li>
</ul>
</div>
<div class="paragraph data-line-381">
<p>En utilisant ce protocole routé en couches d&#8217;oignon, Alice enveloppe chaque élément du chemin dans une couche de cryptage, en commençant par la fin et en remontant. Elle crypte un message à Eric avec la clé publique d&#8217;Eric. Ce message est enveloppé dans un message crypté pour Diana, identifiant Eric comme le prochain destinataire. Le message à Diana est enveloppé dans un message crypté avec la clé publique de Carol et identifiant Diana comme le prochain destinataire. Le message à Carol est crypté avec la clé de Bob. Ainsi, Alice a construit cet &quot;oignon&quot; multicouche chiffré de messages. Elle l&#8217;envoie à Bob, qui ne peut que déchiffrer et déballer la couche externe. À l&#8217;intérieur, Bob trouve un message adressé à Carol qu&#8217;il peut transmettre à Carol mais ne peut pas se déchiffrer. En suivant le chemin, les messages sont transférés, décryptés, transférés, etc., jusqu&#8217;à Eric. Chaque participant ne connaît que le nœud précédent et suivant dans chaque saut.</p>
</div>
<div class="paragraph data-line-383">
<p>Chaque élément du chemin contient des informations sur le HTLC qui doivent être étendues au saut suivant, le montant qui est envoyé, les frais à inclure et l&#8217;expiration du temps de verrouillage CLTV (en blocs) du HTLC. Au fur et à mesure que les informations de route se propagent, les nœuds effectuent des engagements HTLC jusqu&#8217;au saut suivant.</p>
</div>
<div class="paragraph data-line-385">
<p>À ce stade, vous vous demandez peut-être comment il est possible que les nœuds ne connaissent pas la longueur du chemin et leur position dans ce chemin. Après tout, ils reçoivent un message et le transmettent au saut suivant. Ne devient-il pas plus court, leur permettant de déduire la taille du chemin et leur position ? Pour éviter cela, le chemin est toujours fixé à 20 sauts et rempli de données aléatoires. Chaque nœud voit le saut suivant et un message chiffré de longueur fixe à transmettre. Seul le destinataire final voit qu&#8217;il n&#8217;y a pas de saut suivant. Pour tout le monde, il semble qu&#8217;il y ait toujours 20 sauts de plus à faire.</p>
</div>
</div>
<div class="sect3 data-line-387">
<h4 id="_avantages_du_lightning_network">Avantages du Lightning Network</h4>
<div class="paragraph data-line-389">
<p>Un Lightning Network est une technologie de routage de deuxième couche. Il peut être appliqué à toute chaîne de blocs prenant en charge certaines fonctionnalités de base, telles que les transactions multisignatures, les verrous temporels et les contrats intelligents de base.</p>
</div>
<div class="paragraph data-line-391">
<p>Si un réseau Lightning est superposé au réseau Bitcoin, le réseau Bitcoin peut bénéficier d&#8217;une augmentation significative de la capacité, de la confidentialité, de la granularité et de la vitesse, sans sacrifier les principes de fonctionnement sans confiance sans intermédiaires :</p>
</div>
<div class="dlist data-line-393">
<dl>
<dt class="hdlist1">Confidentialité</dt>
<dd>
<p>Les paiements Lightning Network sont beaucoup plus privés que les paiements sur la chaîne de blocs Bitcoin, car ils ne sont pas publics. Bien que les participants à une route puissent voir les paiements se propager sur leurs canaux, ils ne connaissent ni l&#8217;expéditeur ni le destinataire.</p>
</dd>
<dt class="hdlist1">Fongibilité</dt>
<dd>
<p>Un Lightning Network rend beaucoup plus difficile l&#8217;application de la surveillance et des listes noires sur le bitcoin, augmentant la fongibilité de la monnaie.</p>
</dd>
<dt class="hdlist1">Vitesse</dt>
<dd>
<p>Les transactions Bitcoin utilisant Lightning Network sont réglées en millisecondes, plutôt qu&#8217;en minutes, car les HTLC sont effacés sans valider les transactions dans un bloc.</p>
</dd>
<dt class="hdlist1">Granularité</dt>
<dd>
<p>Un réseau Lightning peut permettre des paiements au moins aussi petits que la limite de &quot;poussière&quot; de bitcoin, peut-être même plus petite. Certaines propositions permettent des incréments subsatoshi.</p>
</dd>
<dt class="hdlist1">Capacité</dt>
<dd>
<p>Un Lightning Network augmente la capacité du système Bitcoin de plusieurs ordres de grandeur. Il n&#8217;y a pas de limite supérieure pratique au nombre de paiements par seconde pouvant être acheminés sur un réseau Lightning, car cela dépend uniquement de la capacité et de la vitesse de chaque nœud.</p>
</dd>
<dt class="hdlist1">Fonctionnement sans confiance</dt>
<dd>
<p>Un réseau Lightning utilise des transactions bitcoin entre des nœuds qui fonctionnent comme des pairs sans se faire confiance. Ainsi, un Lightning Network préserve les principes du système Bitcoin, tout en élargissant considérablement ses paramètres de fonctionnement.</p>
</dd>
</dl>
</div>
<div class="paragraph data-line-405">
<p>Bien sûr, comme mentionné précédemment, le protocole Lightning Network n&#8217;est pas le seul moyen de mettre en œuvre des canaux de paiement routés. D&#8217;autres systèmes proposés incluent Tumblebit et Teechan. À l&#8217;heure actuelle, cependant, le Lightning Network a déjà été déployé sur testnet. Plusieurs équipes différentes ont développé des implémentations concurrentes de LN et travaillent à une norme d&#8217;interopérabilité commune (appelée BOLT). Il est probable que Lightning Network sera le premier réseau de canaux de paiement routés à être déployé en production.</p>
</div>
</div>
</div>
<div class="sect2 data-line-407">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph data-line-409">
<p>Nous n&#8217;avons examiné que quelques-unes des applications émergentes qui peuvent être construites en utilisant la chaîne de blocs Bitcoin comme plate-forme de confiance. Ces applications élargissent la portée du bitcoin au-delà des paiements et au-delà des instruments financiers, pour englober de nombreuses autres applications où la confiance est essentielle. En décentralisant la base de confiance, la chaîne de blocs Bitcoin est une plate-forme qui engendrera de nombreuses applications révolutionnaires dans une grande variété d&#8217;industries.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-21 08:31:32 -0400
</div>
</div>
</body>
</html>